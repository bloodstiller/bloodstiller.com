<!DOCTYPE html>
<html lang="en-us">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <meta name="generator" content="Hugo 0.140.0">

    <script src="js/custom.js"></script>
    

    

    
        
            <meta
                name="description"
                content="Bones &amp; All Cyber Security" />
        

        
            <meta
                name="keywords"
                content="hacking, AD, hack the box, HTB, security, pentesting, cybersecurity, pentester, active-directory" />
        

        
            <meta name="author" content="bloodstiller" />
        

    


    <title>
        
            Attacking RPC: Deep Dive &amp; Cheat Sheet |
            Hack the planet
        
    </title>

    


    
    

    
    


    
    


    
    


    
    

    


    
    

    

    

        
            
            <link
                rel="stylesheet"
                href="/reset.min_6107201571472815285.3662e40c85350bf0bcf308b7db81c173e4b690b862d3c3cde460de5155550bf055b7ff48cddb1cf5255e55f0355196d8dec1d49434b2457842cc77ebea198f3f.css"
                integrity="sha512-NmLkDIU1C/C88wi324HBc&#43;S2kLhi08PN5GDeUVVVC/BVt/9Izdsc9SVeVfA1UZbY3sHUlDSyRXhCzHfr6hmPPw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/01_layout.5974c097ff194e0a64d31c28fc478cc38b6290fe28d2cc2dbf5ae52a66751db74e4e7374bc4e25f464ea679f74cd86c474a5367e05c2db34a1b9b273466691e0.css"
                integrity="sha512-WXTAl/8ZTgpk0xwo/EeMw4tikP4o0swtv1rlKmZ1HbdOTnN0vE4l9GTqZ590zYbEdKU2fgXC2zShubJzRmaR4A==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/02_style.8484c853cc558c1c2189842f955ad4be9bf66854698f03f140aef3cfc23174c78eb1ab05b915b7877afac7464e5d70d467c87c1fb3fcbe11a75d379de01e0798.css"
                integrity="sha512-hITIU8xVjBwhiYQvlVrUvpv2aFRpjwPxQK7zz8IxdMeOsasFuRW3h3r6x0ZOXXDUZ8h8H7P8vhGnXTed4B4HmA==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/03_home.6d64455a82e28b01e58f3c37541add9e36fc8ed87562dac91ff06da3f7f11b32ac1cacaa593b2ab2e01acd894659f66c249bd0a261f051038f19a8734c3e1243.css"
                integrity="sha512-bWRFWoLiiwHljzw3VBrdnjb8jth1YtrJH/Bto/fxGzKsHKyqWTsqsuAazYlGWfZsJJvQomHwUQOPGahzTD4SQw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/04_responsive.065451199c1e1cd4f86ac1c8733e3c77eaf215b4972cefff7e7929a2837f5b2cc0e0a04f99f34d58e082812d6102c8cc9b358d21db784e9c4d5e5a8c79f4bc43.css"
                integrity="sha512-BlRRGZweHNT4asHIcz48d&#43;ryFbSXLO//fnkpooN/WyzA4KBPmfNNWOCCgS1hAsjMmzWNIdt4TpxNXlqMefS8Qw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/05_markdown.9afaac6b0a75a2cd9086fb9684dfae53bd04b90e034a252e123a9822c3fa6a5c8a3f88211159b1bd0c6918d19ed7bf3e929ff12de51d06fab0eea77e2374f967.css"
                integrity="sha512-mvqsawp1os2QhvuWhN&#43;uU70EuQ4DSiUuEjqYIsP6alyKP4ghEVmxvQxpGNGe178&#43;kp/xLeUdBvqw7qd&#43;I3T5Zw==" />
        
            
            <link
                rel="stylesheet"
                href="/_theme/css/06_image.ee39fc51345f4c74b8c491bde29d5b2053688d0cc6e937f5660e0f5e3665212473f4cb408cd1749317343308aa41ef1baca3ec3f3aff986ab3764c822790008f.css"
                integrity="sha512-7jn8UTRfTHS4xJG94p1bIFNojQzG6Tf1Zg4PXjZlISRz9MtAjNF0kxc0MwiqQe8brKPsPzr/mGqzdkyCJ5AAjw==" />
        

    


    
    

    

    

    

    


</head>



    <body>
        <header class="header">
    <div class="header_left">
        
    </div>

    <div class="header_middle">
        
            Attacking RPC: Deep Dive &amp; Cheat Sheet -
            Hack the planet
        
    </div>
</header>



        <main>
            <aside class="sidebar">
    



    
    

    
    


    <ul class="section-tree">
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Walkthroughs </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/editorial-box/" title="./walkthroughs/editorial-box/">
                        
                            Editorial HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/doctor-box/" title="./walkthroughs/doctor-box/">
                        
                            Doctor HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/forest-box/" title="./walkthroughs/forest-box/">
                        
                            Forest HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/driver-box/" title="./walkthroughs/driver-box/">
                        
                            Driver HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/timelapse-box/" title="./walkthroughs/timelapse-box/">
                        
                            Timelapse HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/certified-box/" title="./walkthroughs/certified-box/">
                        
                            Certified HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/aero-box/" title="./walkthroughs/aero-box/">
                        
                            Aero HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/administrator-box/" title="./walkthroughs/administrator-box/">
                        
                            Administrator HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/sauna-box/" title="./walkthroughs/sauna-box/">
                        
                            Sauna HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/active-box/" title="./walkthroughs/active-box/">
                        
                            Active HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/cicada-box/" title="./walkthroughs/cicada-box/">
                        
                            Cicada HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/authority-box/" title="./walkthroughs/authority-box/">
                        
                            Authority HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/evilcups-box/" title="./walkthroughs/evilcups-box/">
                        
                            EvilCUPS HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/resolute-box/" title="./walkthroughs/resolute-box/">
                        
                            Resolute HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/fuse-box/" title="./walkthroughs/fuse-box/">
                        
                            Fuse HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/cascade-box/" title="./walkthroughs/cascade-box/">
                        
                            Cascade HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/monteverde-box/" title="./walkthroughs/monteverde-box/">
                        
                            Monteverde HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/outdated-box/" title="./walkthroughs/outdated-box/">
                        
                            Outdated HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/scrambled-box/" title="./walkthroughs/scrambled-box/">
                        
                            Scrambled HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/escape-box/" title="./walkthroughs/escape-box/">
                        
                            Escape HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/hospital-box/" title="./walkthroughs/hospital-box/">
                        
                            Hospital HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/intelligence-box/" title="./walkthroughs/intelligence-box/">
                        
                            Intelligence HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/manager-box/" title="./walkthroughs/manager-box/">
                        
                            Manager HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/access-box/" title="./walkthroughs/access-box/">
                        
                            Access HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/remote-box/" title="./walkthroughs/remote-box/">
                        
                            Remote HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/support-box/" title="./walkthroughs/support-box/">
                        
                            Support HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/walkthroughs/return-box/" title="./walkthroughs/return-box/">
                        
                            Return HTB Walkthrough
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Articles </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/understandingasreproasting/" title="./articles/understandingasreproasting/">
                        
                            Understanding AS-REP Roasting Attacks: A Deep Dive
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/understandingdownloadcradles/" title="./articles/understandingdownloadcradles/">
                        
                            Understanding PowerShell Download Cradles: A Deep Dive
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/understanding2023-28252-clfs/" title="./articles/understanding2023-28252-clfs/">
                        
                            Understanding CVE-2023-28252: Deep Dive into the CLFS Privilege Escalation Vulnerability
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/understandingthemebleedcve-2023-38146/" title="./articles/understandingthemebleedcve-2023-38146/">
                        
                            Understanding CVE-2023-38146: Deep Dive into the ThemeBleed Vulnerability
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/understandingcupsexploitation/" title="./articles/understandingcupsexploitation/">
                        
                            Understanding the CUPS Exploit Chain: A Deep Dive into CVE-2024-4176, CVE-2024-4175, CVE-2024-4177 and CVE-2024-4076
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/understandingnopacexploit/" title="./articles/understandingnopacexploit/">
                        
                            Understanding the NoPac Exploit: A Deep Dive into CVE-2021-42278 and CVE-2021-42287
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/seloaddriverprivilegeescalation/" title="./articles/seloaddriverprivilegeescalation/">
                        
                            Understanding SeLoadDriverPrivilege Escalation: A Deep Dive
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/azureadconnectattack/" title="./articles/azureadconnectattack/">
                        
                            Understanding Azure AD Connect Exploitation &amp; Privilege Escalation
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/shadowcredentialsattack/" title="./articles/shadowcredentialsattack/">
                        
                            Understanding the Shadow Credentials Attack Vector
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/articles/deserializationattacksexplained/" title="./articles/deserializationattacksexplained/">
                        
                            Understanding .NET Deserialization Exploits: A Deep Dive
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Tools </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/tools/ldapire/" title="./tools/ldapire/">
                        
                            LDAPire: LDAP Enumeration Tool
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/tools/automatingqemukalivm/" title="./tools/automatingqemukalivm/">
                        
                            Automating Kali VM Setup with QEMU
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/tools/bloodserver/" title="./tools/bloodserver/">
                        
                            BloodServer: A Secure File Transfer Tool for Penetration Testers
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir opened-dir"
                    >
                    <span class="dir-text"> Cheatsheets </span>

                    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="http://localhost:1313/cheatsheets/ldap-cheatsheet/" title="./cheatsheets/ldap-cheatsheet/">
                        
                            Attacking LDAP: Deep Dive &amp; Cheatsheet
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/cheatsheets/rpc-cheatsheet/" title="./cheatsheets/rpc-cheatsheet/">
                        
                            Attacking RPC: Deep Dive &amp; Cheat Sheet
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/love-box/" title="./love-box/">
                        
                            Love HTB Walkthrough
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="http://localhost:1313/aboutme/" title="./aboutme/">
                        
                            about me
                        
                    </a>
                </li>
            
        
    </ul>


</aside>
<aside class="exapandable"></aside>


            
    <article class="main">
        <button
    class="sidebar-toggle-btn"
    type="menu"
    aria-expanded="false"
    aria-haspopup="true">
    <i class="bi bi-list"></i>
</button>



        <div class="title">
            <h1 class="title-header">
                Attacking RPC: Deep Dive &amp; Cheat Sheet
            </h1>

            <div class="author-date-readtime">
                

                    
                        <div class="author" title="Author">
                            <i class="bi bi-person"></i>
                            <a
                                href="/author/bloodstiller/"
                                class="cat-btn">
                                bloodstiller
                            </a>
                        </div>
                    

                

                
                    <div class="date" title="Date">
                        <i class="bi bi-calendar3"></i>
                        <time
                            datetime="2024.16.10"
                            >2024.16.10
                        </time>
                    </div>
                

                
                    <div
                        class="readtime"
                        title="Time to Read">
                        <i class="bi bi-clock"></i>
                        9 mins to read
                    </div>
                
            </div>
        </div>

        <div class="article-meta">
            

            
                <div class="tags">
                    <i
                        class="bi bi-tags"
                        title="Tags"></i>
                    
                        <a
                            href="/tags/pentesting/"
                            class="tag-btn">
                            Pentesting
                        </a>
                    
                        <a
                            href="/tags/rpc/"
                            class="tag-btn">
                            RPC
                        </a>
                    
                        <a
                            href="/tags/cheatsheet/"
                            class="tag-btn">
                            CheatSheet
                        </a>
                    
                </div>
            

            
                <div class="breadcumb">
                    <i class="bi bi-folder"></i>
                    
    
    




<a href="http://localhost:1313/" class="bread-btn">
    
        <i class="bi bi-house-fill"></i>
    

    
        Home
    
</a>




    /



<a href="http://localhost:1313/cheatsheets/" class="bread-btn">
    

    
        Cheatsheets
    
</a>




    /



<a href="http://localhost:1313/cheatsheets/rpc-cheatsheet/" class="bread-btn">
    

    
        
            Attacking RPC: Deep Dive &amp; Cheat Sheet
        

    
</a>

                </div>
            

            
        </div>

        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#port-number--s">Port Number(s):</a>
      <ul>
        <li><a href="#rpc-over-http">RPC over HTTP:</a></li>
      </ul>
    </li>
    <li><a href="#rpc-process--deep-dive">RPC Connection Process (Deep Dive):</a>
      <ul>
        <li><a href="#connection">Connection:</a></li>
        <li><a href="#execution">Execution:</a></li>
        <li><a href="#response">Response</a></li>
      </ul>
    </li>
    <li><a href="#befb8b">+Enumerating RPC+</a>
      <ul>
        <li><a href="#enumerating-rpc-using-rpcclient">Enumerating RPC using RPCclient:</a></li>
        <li><a href="#enumerating-rpc-using-rpcinfo">Enumerating RPC using rpcinfo:</a></li>
        <li><a href="#enumerating-rpc-using-nmap">Enumerating RPC using Nmap:</a></li>
        <li><a href="#enumerating-rpc-using-impacket-rpcdump">Enumerating RPC using impacket-rpcdump:</a></li>
      </ul>
    </li>
    <li><a href="#16c913">+Attacking RPC+</a>
      <ul>
        <li><a href="#attacking-rpc-using-rpcclient">Attacking RPC using <code>rpcclient</code>:</a></li>
      </ul>
    </li>
    <li><a href="#6dca67">Defending RPC</a>
      <ul>
        <li><a href="#common-rpc-vulnerabilities">Common RPC Vulnerabilities:</a></li>
      </ul>
    </li>
    <li><a href="#rpc-information">RPC Protocol Information:</a>
      <ul>
        <li><a href="#rpc-filtering">RPC Filtering:</a></li>
        <li><a href="#definition">Definition:</a></li>
        <li><a href="#components">Components:</a></li>
        <li><a href="#types">Types:</a></li>
        <li><a href="#protocols">Protocols:</a></li>
        <li><a href="#common-uses">Common Uses:</a></li>
        <li><a href="#advantages">Advantages:</a></li>
        <li><a href="#disadvantages">Disadvantages:</a></li>
        <li><a href="#implementation-considerations">Implementation Considerations:</a></li>
        <li><a href="#security-concerns">Security Concerns:</a></li>
        <li><a href="#relevance-to-penetration-testing">Relevance to Penetration Testing:</a></li>
        <li><a href="#common-rpc-frameworks">Common RPC Frameworks:</a></li>
      </ul>
    </li>
    <li><a href="#rpc-vs-dot-rest">RPC vs. REST</a>
      <ul>
        <li><a href="#rpc">RPC:</a></li>
        <li><a href="#rest">REST:</a></li>
      </ul>
    </li>
    <li><a href="#further-reading">Further Reading</a></li>
  </ul>
</nav>
        


        <div class="content">
            
                <h2 id="introduction">Introduction</h2>
<p>RPC (Remote Procedure Call) is a protocol that allows a program to execute a procedure or function on another computer as if it were a local call. This cheat sheet provides a comprehensive overview of RPC, including its functionality, security implications, and relevance to penetration testing.</p>
<h2 id="port-number--s">Port Number(s):</h2>
<ul>
<li>
<p><strong>RPC (Remote Procedure Call) does not operate on a specific port itself</strong>.</p>
<ul>
<li>Instead, it relies on underlying protocols to establish connections and transfer data.</li>
<li>RPC uses different ports to facilitate communication between systems and services. Here&rsquo;s a summary of the key ports involved:</li>
</ul>
</li>
<li>
<p><strong>Port</strong> <code>135</code> (<code>TCP/UDP</code>):</p>
<ul>
<li>Purpose: Endpoint Mapper (EPM) for Microsoft RPC.</li>
<li>Description: Acts as a directory service to map service requests to the appropriate dynamically assigned ports.</li>
</ul>
</li>
<li>
<p><strong>Dynamic Ports</strong> (<code>TCP/UDP</code>):</p>
<ul>
<li><strong>Purpose</strong>: RPC services can use dynamically assigned ports.</li>
<li><strong>Description</strong>: After an initial connection via port 135, RPC services typically assign dynamic ports in the range of 49152–65535.</li>
<li>+Note+: The dynamic port range may differ depending on the OS and configuration.</li>
</ul>
</li>
<li>
<p><strong>Port</strong> <code>593</code> (<code>TCP</code>):</p>
<ul>
<li><strong>Purpose</strong>: HTTP RPC (RPC over HTTP).</li>
<li><strong>Description</strong>: Allows RPC communication over HTTP for remote management tasks.</li>
<li><strong>Usage</strong>: Can be used to bypass firewalls that block traditional RPC ports.</li>
<li><strong>Benefits</strong>: Useful for remote management in environments where direct RPC access is restricted.</li>
<li><strong>Enumeration</strong>: Can be enumerated using tools like Nmap with appropriate scripts.</li>
</ul>
</li>
<li>
<p><strong>Port</strong> <code>80</code> (<code>TCP</code>) and <strong>Port</strong> <code>443</code> (<code>TCP</code>):</p>
<ul>
<li><strong>Purpose</strong>: Standard HTTP and HTTPS ports, which can be used for RPC over HTTP(S).</li>
<li><strong>Description</strong>: When configured, allows RPC traffic to be tunneled through standard web protocols.</li>
<li><strong>Usage</strong>: Commonly used in scenarios where traditional RPC ports are blocked by firewalls.</li>
</ul>
</li>
</ul>
<h3 id="rpc-over-http">RPC over HTTP:</h3>
<ul>
<li>RPC over HTTP (Port 593) can be used to bypass firewalls that block traditional RPC ports.</li>
<li>Useful for remote management in environments where direct RPC access is restricted.</li>
<li>Can be enumerated using tools like Nmap with appropriate scripts.</li>
</ul>
<h2 id="rpc-process--deep-dive">RPC Connection Process (Deep Dive):</h2>
<h3 id="connection">Connection:</h3>
<ol>
<li>
<p><strong>Client initiates a request to the server</strong>:</p>
<ul>
<li>Client prepares the procedure name and parameters.</li>
<li>Client stub is invoked, which acts as a proxy for the remote procedure.</li>
</ul>
</li>
<li>
<p><strong>Parameters are marshalled (serialized) for transmission</strong>:</p>
<ul>
<li>Data is converted into a standardized format (e.g., XDR, Protocol Buffers).</li>
<li>Complex data structures are flattened into a byte stream.</li>
</ul>
</li>
<li>
<p><strong>Request is sent over the network</strong>:</p>
<ul>
<li>The marshalled data is packaged with metadata (e.g., procedure ID, version).</li>
<li>Transmission occurs using the underlying network protocol (e.g., TCP/IP).</li>
</ul>
</li>
</ol>
<h3 id="execution">Execution:</h3>
<ol>
<li>
<p><strong>Server receives and unmarshalls the request</strong>:</p>
<ul>
<li>Server stub receives the incoming request.</li>
<li>Data is deserialized back into a format the server can process.</li>
</ul>
</li>
<li>
<p><strong>Server executes the requested procedure</strong>:</p>
<ul>
<li>The appropriate local procedure is identified and called.</li>
<li>Server performs the requested operation with the provided parameters.</li>
</ul>
</li>
</ol>
<h3 id="response">Response</h3>
<ol>
<li>
<p><strong>Results are marshalled and sent back to the client</strong>:</p>
<ul>
<li>Output data is serialized for network transmission.</li>
<li>Response is packaged with any necessary metadata.</li>
</ul>
</li>
<li>
<p><strong>Client unmarshalls and processes the results</strong>:</p>
<ul>
<li>Client stub receives and deserializes the response.</li>
<li>Data is presented to the client application in the expected format.</li>
</ul>
</li>
</ol>
<h2 id="befb8b">+Enumerating RPC+</h2>
<ul>
<li>You can see some of these enumeration steps performed on my walkthrough&rsquo;s for Cascade &amp; Fuse:
<ul>
<li><a href="https://bloodstiller.com/walkthroughs/cascade-box">https://bloodstiller.com/walkthroughs/cascade-box</a></li>
<li><a href="https://bloodstiller.com/walkthroughs/fuse-box">https://bloodstiller.com/walkthroughs/fuse-box</a></li>
</ul>
</li>
</ul>
<h3 id="enumerating-rpc-using-rpcclient">Enumerating RPC using RPCclient:</h3>
<ul>
<li>
<p><strong>Remember we can pass the pash with</strong> <code>rpcclient</code> <strong>too</strong>:</p>
<ul>
<li><code>--pw-nt-hash &lt;hash&gt;</code></li>
</ul>
</li>
<li>
<p><!-- raw HTML omitted -->+Note+: Sometimes not all command are available due to restrictions<!-- raw HTML omitted --></p>
</li>
</ul>
<h4 id="connecting-with-rpcclient-using-a-null-anonymous-session">Connecting with rpcclient using a null/anonymous session:</h4>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="rpcclient%20-U%20%22%22%20[ip]%0arpcclient%20-U%20%27%25%27%20[ip]">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rpcclient -U <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">[</span>ip<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>rpcclient -U <span style="color:#e6db74">&#39;%&#39;</span> <span style="color:#f92672">[</span>ip<span style="color:#f92672">]</span></span></span></code></pre></div>
    
</div>
<ul>
<li>Try both of these one may work and the other may not</li>
</ul>
<h4 id="enumerating-users-using-rpcclient">Enumerating users using rpcclient:</h4>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Enumerates domain users: </span>
</span></span><span style="display:flex;"><span>enumdomusers</span></span></code></pre></div>
    
</div>
<ul>
<li>+Note+:
<ul>
<li>We will be given the users RID which can then be used with <code>queryuser</code> to enumerate further.</li>
<li>This provides similar information to LDAP including Description etc</li>
</ul>
</li>
</ul>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#Query the user RID we have just found above:</span>
</span></span><span style="display:flex;"><span>queryuser <span style="color:#f92672">[</span>RID<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Example</span>
</span></span><span style="display:flex;"><span>queryuser 0x3e8</span></span></code></pre></div>
    
</div>
<ul>
<li>+Note+:
<ul>
<li>Used with the RID discovered with <code>enumdomusers</code> above to enumerate users.</li>
<li>We can then get the +RID of the group+ to then user the <code>querygroup</code> command.</li>
</ul>
</li>
</ul>
<h4 id="enumerating-domain-and-local-groups-with-rpcclient">Enumerating Domain &amp; Local Groups with rpcclient:</h4>
<!-- raw HTML omitted -->
<h5 id="enumerating-domain-alias-groups">Enumerating Domain alias groups:</h5>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#Domain alias Groups:</span>
</span></span><span style="display:flex;"><span>enumalsgroups domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Local Groups:</span>
</span></span><span style="display:flex;"><span>enumalsgroups builtin</span></span></code></pre></div>
    
</div>
<ul>
<li>
<p><strong>Alias Groups Explanation</strong>:</p>
<ul>
<li>Alias Groups (Local Groups):
<ul>
<li>These groups are local to the machine or server, or specific to the domain controller but aren&rsquo;t part of the global domain groups.</li>
<li>Alias groups often correspond to built-in groups on Windows (e.g., Administrators, Backup Operators), but they can also be domain-specific local groups.</li>
<li>Alias groups can only contain members from the local domain.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Scope</strong>:
-   <code>enumalsgroups domain/builtin</code>: Lists local alias groups that are specific to the domain controller or server.</p>
</li>
</ul>
<!-- raw HTML omitted -->
<h5 id="enumerating-domain-wide-groups">Enumerating Domain Wide Groups:</h5>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#Domain Wide Groups:</span>
</span></span><span style="display:flex;"><span>enumdomgroups
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Query the group of the user above:</span>
</span></span><span style="display:flex;"><span>querygroup <span style="color:#f92672">[</span>GroupRID<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Example</span>
</span></span><span style="display:flex;"><span>querygroup 0x201</span></span></code></pre></div>
    
</div>
<ul>
<li><strong>Scope</strong>:
<ul>
<li><code>enumdomgroups</code>: Lists domain-wide groups that are used across the Active Directory domain.</li>
</ul>
</li>
</ul>
<h4 id="further-enumeration-using-rpcclient">Further Enumeration Using rpcclient:</h4>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Enumerating the whole domain: </span>
</span></span><span style="display:flex;"><span>enumdomains
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enumerate System privileges:</span>
</span></span><span style="display:flex;"><span>enumprivs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Retrieve Information about Available Services using rpcclient: </span>
</span></span><span style="display:flex;"><span>querydispinfo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enumerate Domain Groups using rpcclient: </span>
</span></span><span style="display:flex;"><span>enumdomgroups
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Resolve SIDs to Names using rpcclient: </span>
</span></span><span style="display:flex;"><span>lookupsids <span style="color:#f92672">[</span>SID<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enumerate System Privileges using rpcclient: </span>
</span></span><span style="display:flex;"><span>enumprivs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enumerate Shared Resources using rpcclient: </span>
</span></span><span style="display:flex;"><span>netshareenum
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># List Detailed Information about Shared Resources using rpcclient: </span>
</span></span><span style="display:flex;"><span>netshareenumall
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Retrieve Information about a Specific Share using rpcclient: </span>
</span></span><span style="display:flex;"><span>netsharegetinfo <span style="color:#f92672">[</span>sharename<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create a New Share using rpcclient: </span>
</span></span><span style="display:flex;"><span>netshareadd <span style="color:#e6db74">&#34;C:\path&#34;</span> <span style="color:#e6db74">&#34;sharename&#34;</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;Description&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enumerate Trusted Domains using rpcclient: </span>
</span></span><span style="display:flex;"><span>enumtrustdoms
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enumerate Printers</span>
</span></span><span style="display:flex;"><span>enumprinters</span></span></code></pre></div>
    
</div>
<ul>
<li>I used <code>enumprinters</code> in the HTB box Fuse to reveal a cleartext credential:
<ul>
<li><a href="https://bloodstiller.com/walkthroughs/fuse-box/">https://bloodstiller.com/walkthroughs/fuse-box/</a></li>
</ul>
</li>
</ul>
<h4 id="enumerate-password-policy-using-rpcclient">Enumerate Password Policy using rpcclient:</h4>
<ul>
<li><strong>Command</strong>: <code>enumdompwinfo</code></li>
<li>+Example output+:







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>rpcclient $&gt; getdompwinfo
</span></span><span style="display:flex;"><span>min_password_length: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>password_properties: 0x00000000</span></span></code></pre></div>
    
</div>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Understanding <code>password_properties</code>:</p>
<ul>
<li>
<p><code>password_properties</code> is a bitmask, where different bits control specific password policies.</p>
</li>
<li>
<p><strong>Here are the common flags and what each bit represents</strong>:</p>
<ul>
<li>
<p><strong>Hex Value</strong>: <code>0x00000001</code></p>
</li>
<li>
<p><strong>Flag</strong>: <code>DOMAIN_PASSWORD_COMPLEX</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Enforces password complexity (requires uppercase, lowercase, digits, symbols)</p>
</li>
<li>
<p><strong>Hex Value</strong>: <code>0x00000002</code></p>
</li>
<li>
<p><strong>Flag</strong>: <code>DOMAIN_PASSWORD_NO_ANON_CHANGE</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Prevents anonymous users from changing passwords</p>
</li>
<li>
<p><strong>Hex Value</strong>: <code>0x00000004</code></p>
</li>
<li>
<p><strong>Flag</strong>: <code>DOMAIN_PASSWORD_NO_CLEAR_CHANGE</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Prevents passwords from being sent in cleartext</p>
</li>
<li>
<p><strong>Hex Value</strong>: <code>0x00000008</code></p>
</li>
<li>
<p><strong>Flag</strong>: <code>DOMAIN_LOCKOUT_ADMINS</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Locks out administrators as well when lockout occurs</p>
</li>
<li>
<p><strong>Hex Value</strong>: <code>0x00000010</code></p>
</li>
<li>
<p><strong>Flag</strong>: <code>DOMAIN_PASSWORD_STORE_CLEARTEXT</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Allows storing passwords using reversible encryption (cleartext)</p>
</li>
<li>
<p><strong>Hex Value</strong>: <code>0x00000020</code></p>
</li>
<li>
<p><strong>Flag</strong>: <code>DOMAIN_REFUSE_PASSWORD_CHANGE</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Prevents users from changing their password</p>
</li>
<li>
<p><strong>Hex Value</strong>: <code>0x00000000</code></p>
</li>
<li>
<p><strong>Meaning</strong>: Means that none of these password restrictions are enabled.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Enumerate Specific User Password Policy using rpcclient: </span>
</span></span><span style="display:flex;"><span>getusrdompwinfo <span style="color:#f92672">[</span>UserRID<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>getusrdompwinfo 0x46f</span></span></code></pre></div>
    
</div>
<h4 id="searching-for-custom-rid-s-using-rpcclient">Searching for custom RID&rsquo;s using rpcclient:</h4>
<ul>
<li>
<p><strong>Bruteforce Custom User</strong> <code>RID's</code> <strong>with forloop</strong>:</p>
<ul>
<li><strong>Command</strong>:
<ul>
<li><code>for i in \\((seq 500 1100);do rpcclient -N -U &quot;&quot; [ip] -c &quot;queryuser 0x\\)(printf '%x\n' $i)&quot; | grep &quot;User Name\\|user_rid\\|group_rid&quot; &amp;amp;&amp;amp; echo &quot;&quot;;done</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>+Note+:</p>
<ul>
<li>This is used for searching for custom RIDs (see below)</li>
<li>The values <code>500</code> &amp; <code>1100</code> can be modified.</li>
</ul>
</li>
</ul>
<h5 id="explanation-of-the-command">Explanation of the Command:</h5>
<ul>
<li>
<p><code>Loop (for i in $(seq 500 1100))</code>:</p>
<ul>
<li>The loop iterates over a range of values <code>(500 to 1100)</code>, converting each value to a hexadecimal format (<code>via printf '%x\n' $i</code>) because RIDs are expressed in hexadecimal.</li>
</ul>
</li>
<li>
<p><code>rpcclient -N -U &quot;&quot; &lt;ip&gt;</code>:</p>
<ul>
<li><code>-N</code>: Specifies no password, used for anonymous connections.</li>
<li><code>-U &quot;&quot;</code>: Attempts the connection without a username.</li>
<li><code>[ip]</code>: The IP address of the target server.</li>
</ul>
</li>
<li>
<p><code>queryuser 0x&lt;rid&gt;</code>:</p>
<ul>
<li>Queries user information based on the given RID (Relative Identifier) from the current iteration of the loop, formatted as a hexadecimal value (e.g., 0x1f4 for RID 500).</li>
</ul>
</li>
<li>
<p><code>grep &quot;User Name\|user_rid\|group_rid&quot;</code>:</p>
<ul>
<li>Filters the output to display only lines containing user name, user RID, or group RID for easier readability.</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<h5 id="why-rid-stop-around-500">Why <code>RID</code> Stop Around <code>500</code>:</h5>
<ul>
<li>
<p><strong>Default RIDs in Windows</strong>:</p>
<ul>
<li>
<p>The first <code>500</code> RIDs are typically reserved for well-known or default accounts and groups in Windows systems. For example:</p>
<ul>
<li><code>0x1f4</code> (500 in decimal) is often assigned to the Administrator account.</li>
<li><code>0x1f5</code> (501) is the Guest account.</li>
<li>Other default users and built-in groups (e.g., Administrators group, Users group) are typically assigned RIDs in this range.</li>
</ul>
</li>
<li>
<p><strong>Custom</strong> <code>RIDs</code>:</p>
<ul>
<li>RIDs above 500 are typically assigned to custom-created users and groups. When administrators create new users or groups, the system automatically assigns them higher RIDs, which is why your search starts at 500 and extends up to 1100 in this case. This range is where you would expect to find custom user accounts or groups.</li>
</ul>
</li>
<li>
<p><strong>Purpose of the Command</strong>:</p>
<ul>
<li>Search for Custom User RIDs:
<ul>
<li>Since the well-known accounts usually stop around 500, we are searching through RIDs in the 500 to 1100 range, which is where custom-created users or groups are likely to have RIDs.</li>
<li>This method can be useful in penetration testing or during enumeration to discover non-default user accounts that have been created on the system, particularly when we don’t have a complete list of users.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<h3 id="enumerating-rpc-using-rpcinfo">Enumerating RPC using rpcinfo:</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="rpcinfo%20[ip/url]%0arpcinfo%2010.129.203.101">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rpcinfo <span style="color:#f92672">[</span>ip/url<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>rpcinfo 10.129.203.101</span></span></code></pre></div>
    
</div>
<h3 id="enumerating-rpc-using-nmap">Enumerating RPC using Nmap:</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="nmap%20-p%20135%20--script=msrpc-enum%20[target]%0anmap%20-p%20135%20--script=rpc-grind%20[target]">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p <span style="color:#ae81ff">135</span> --script<span style="color:#f92672">=</span>msrpc-enum <span style="color:#f92672">[</span>target<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>nmap -p <span style="color:#ae81ff">135</span> --script<span style="color:#f92672">=</span>rpc-grind <span style="color:#f92672">[</span>target<span style="color:#f92672">]</span></span></span></code></pre></div>
    
</div>
<ul>
<li>+Note+: These Nmap scripts can provide valuable information about RPC services and endpoints.</li>
</ul>
<h3 id="enumerating-rpc-using-impacket-rpcdump">Enumerating RPC using impacket-rpcdump:</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="impacket-rpcdump%20[domain/]username[:password]@target%0aimpacket-rpcdump%20./Administrator:password123@192.168.1.100">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>impacket-rpcdump <span style="color:#f92672">[</span>domain/<span style="color:#f92672">]</span>username<span style="color:#f92672">[</span>:password<span style="color:#f92672">]</span>@target
</span></span><span style="display:flex;"><span>impacket-rpcdump ./Administrator:password123@192.168.1.100</span></span></code></pre></div>
    
</div>
<ul>
<li>+Note+: This tool can enumerate RPC endpoints and provide detailed information about available interfaces.</li>
</ul>
<h2 id="16c913">+Attacking RPC+</h2>
<h3 id="attacking-rpc-using-rpcclient">Attacking RPC using <code>rpcclient</code>:</h3>
<ul>
<li><strong>Remember we can pass the pash with</strong> <code>rpcclient</code> <strong>too</strong>:
<ul>
<li><code>--pw-nt-hash &lt;hash&gt;</code></li>
</ul>
</li>
</ul>
<h4 id="change-a-users-password-using-rpcclient">Change a users password using rpcclient:</h4>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="chgpasswd3%20[user]%20[oldPass]%20[newPass]%0achgpasswd3%20n.barley%20wellbum%20wellbum14">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chgpasswd3 <span style="color:#f92672">[</span>user<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>oldPass<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>newPass<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>chgpasswd3 n.barley wellbum wellbum14</span></span></code></pre></div>
    
</div>
<h4 id="create-a-new-user-using-rpcclient">Create a new user using rpcclient:</h4>
<ul>
<li><strong>Create a new user on the remote Windows system using</strong> <code>rpcclient</code> <em>with the</em> <code>createdomuser</code> <strong>username command</strong>:</li>
</ul>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="createdomuser%20[username]%0asetuserinfo2%20username%2024%20[NewPassword]">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>createdomuser <span style="color:#f92672">[</span>username<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>setuserinfo2 username <span style="color:#ae81ff">24</span> <span style="color:#f92672">[</span>NewPassword<span style="color:#f92672">]</span></span></span></code></pre></div>
    
</div>
<ul>
<li>+Note+:
<ul>
<li>In this example, the <code>24</code> value represents necessary Windows information class constant to set a user password.</li>
<li>The value will always be <code>24</code> when setting a password.</li>
</ul>
</li>
</ul>
<h4 id="create-a-new-share-using-rpcclient">Create a new share using rpcclient:</h4>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>netshareadd <span style="color:#e6db74">&#34;C:\[FolderToShare]&#34;</span> <span style="color:#e6db74">&#34;[NameOfShare]&#34;</span> <span style="color:#f92672">[</span>ShareType<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;[ShareDescription]&#34;</span>
</span></span><span style="display:flex;"><span>netshareadd <span style="color:#e6db74">&#34;C:\Windows&#34;</span> <span style="color:#e6db74">&#34;Windows&#34;</span> <span style="color:#ae81ff">10</span> <span style="color:#e6db74">&#34;Windows Share&#34;</span></span></span></code></pre></div>
    
</div>
<ul>
<li>+Note+:
<ul>
<li><code>10</code>: This is the share type. The value 10 indicates that it is a disk drive. Other values can represent different types of shares (e.g., printers).</li>
</ul>
</li>
</ul>
<h4 id="remove-a-shared-resource-using-rpcclient">Remove a Shared Resource using rpcclient:</h4>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="netshareremove%20[sharename]">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>netshareremove <span style="color:#f92672">[</span>sharename<span style="color:#f92672">]</span></span></span></code></pre></div>
    
</div>
<h2 id="6dca67">Defending RPC</h2>
<ul>
<li>Implement strong authentication and authorization</li>
<li>Use encryption for data in transit (e.g., TLS)</li>
<li>Regularly update and patch RPC services</li>
<li>Implement proper input validation and sanitization</li>
<li>Use firewalls and network segmentation to control RPC traffic</li>
<li>Monitor and log RPC activities for suspicious behavior</li>
</ul>
<h3 id="common-rpc-vulnerabilities">Common RPC Vulnerabilities:</h3>
<ul>
<li>Buffer Overflows: Especially in older systems or poorly implemented RPC services.</li>
<li>Null Session Attacks: When anonymous access is allowed.</li>
<li>RPC Amplification Attacks: Used in DDoS scenarios.</li>
<li>Improper Access Controls: Leading to unauthorized access to RPC functions.</li>
</ul>
<h2 id="rpc-information">RPC Protocol Information:</h2>
<h3 id="rpc-filtering">RPC Filtering:</h3>
<ul>
<li>Windows systems often implement RPC filtering to restrict access.</li>
<li>Can be configured through Group Policy or Windows Firewall with Advanced Security.</li>
</ul>
<h3 id="definition">Definition:</h3>
<ul>
<li>A protocol for executing code on a remote server.</li>
</ul>
<h3 id="components">Components:</h3>
<ul>
<li><strong>Client</strong>: Sends the request.</li>
<li><strong>Server</strong>: Executes the function and returns a result.</li>
</ul>
<h3 id="types">Types:</h3>
<ol>
<li><strong>Synchronous RPC</strong>: Client waits for the server to respond.</li>
<li><strong>Asynchronous RPC</strong>: Client continues operation without waiting.</li>
</ol>
<h3 id="protocols">Protocols:</h3>
<ul>
<li>XML-RPC</li>
<li>JSON-RPC</li>
<li>gRPC</li>
</ul>
<h3 id="common-uses">Common Uses:</h3>
<ul>
<li>Distributed computing</li>
<li>Web services</li>
<li>APIs</li>
</ul>
<h3 id="advantages">Advantages:</h3>
<ul>
<li>Simplifies development of distributed applications</li>
<li>Allows for heterogeneous environments (different languages/platforms)</li>
<li>Can improve performance in certain scenarios</li>
</ul>
<h3 id="disadvantages">Disadvantages:</h3>
<ul>
<li>Can introduce network-related complexities</li>
<li>Potential security risks if not properly implemented</li>
<li>May have higher latency compared to local procedure calls</li>
</ul>
<h3 id="implementation-considerations">Implementation Considerations:</h3>
<ul>
<li>Error handling for network issues</li>
<li>Version compatibility between client and server</li>
<li>Security measures (authentication, encryption)</li>
<li>Performance optimization (caching, connection pooling)</li>
</ul>
<h3 id="security-concerns">Security Concerns:</h3>
<ul>
<li>Unauthorized access</li>
<li>Data interception</li>
<li>Denial-of-service attacks</li>
</ul>
<h3 id="relevance-to-penetration-testing">Relevance to Penetration Testing:</h3>
<ul>
<li>Can be used to enumerate Active Directory environments.</li>
<li>Enumeration of exposed functions</li>
<li>Injection vulnerabilities</li>
<li>Insecure data transmission</li>
</ul>
<h3 id="common-rpc-frameworks">Common RPC Frameworks:</h3>
<ul>
<li>gRPC (Google)</li>
<li>Apache Thrift</li>
<li>XML-RPC</li>
<li>JSON-RPC</li>
<li>Java RMI (Remote Method Invocation)</li>
</ul>
<h2 id="rpc-vs-dot-rest">RPC vs. REST</h2>
<h3 id="rpc">RPC:</h3>
<ul>
<li>Function-centric: Focuses on actions and procedures</li>
<li>Typically uses POST method for all operations</li>
<li>Often uses a single endpoint</li>
<li>Can be more efficient for complex operations</li>
</ul>
<h3 id="rest">REST:</h3>
<ul>
<li>Resource-centric: Focuses on data entities</li>
<li>Uses different HTTP methods (GET, POST, PUT, DELETE)</li>
<li>Uses multiple endpoints based on resources</li>
<li>Generally simpler and more widely used for web APIs</li>
</ul>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows/win32/rpc/rpc-start-page">Microsoft RPC Documentation</a></li>
<li><a href="https://grpc.io/docs/">gRPC Documentation</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html">OWASP Web Service Security Cheat Sheet</a></li>
</ul>

            
        </div>
    </article>

        </main>

        <footer class="footer">
    <div class="footer-left">
        <ul class="social">
            
                <li>All Rights Reserved ®.</li>
            

            
                <li>Bloodstiller</li>
            

            
                
            
                
            
                
                    <li>
                        
                            <a href="https://github.com/bloodstiller" target="_blank">
                                <i class="bi-github"></i>
                            </a>
                        

                    </li>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </ul>
    </div>

    <div class="footer-right">
        <ul class="control status clearfix">
            
                <li>
                    
                        Word Count:
                        1914
                    
                </li>
            


            
                <li>en</li>
            

            

            

            
                <li>
                    
                        Last modified: &nbsp;
                        <time>
                            Oct 16 2024 00:00:00
                        </time>
                    
                </li>
            

            
        </ul>
    </div>
</footer>

    </body>

    






















    
        
        <script
            type="text/javascript"
            src="/_theme/js/codeblock_copy.c59588ba3a219dafab515508b0bcd2d0592dc9e0e08de20dc1983bfd8cb69d03d37c78eadd81ee7bef724570f9e4286d9ea1c53ca59d3711c0bcad9e9134d0e9.js"
            integrity="sha512-xZWIujohna&#43;rUVUIsLzS0FktyeDgjeINwZg7/Yy2nQPTfHjq3YHue&#43;9yRXD55ChtnqHFPKWdNxHAvK2ekTTQ6Q=="></script>
    
        
        <script
            type="text/javascript"
            src="/_theme/js/custom.e55ae031ca7d8c1e9bde9a72058dd382e3de5ff9b7df41d6d0e4ccb82ff9962e74b4865412dc15db16e5f16012d5cf9e2330b9826a3a36d5a272077f70e1341b.js"
            integrity="sha512-5VrgMcp9jB6b3ppyBY3TguPeX/m330HW0OTMuC/5li50tIZUEtwV2xbl8WAS1c&#43;eIzC5gmo6NtWicgd/cOE0Gw=="></script>
    
        
        <script
            type="text/javascript"
            src="/_theme/js/dir_toggle.e6f8c63f3ed9aefa9cedb3be3d5ab67e00bc3cf87a8dd7ef1ed55d642e9a7d80837636a26ae77f967f2aa74a44ae70c4134e25abca587f048c60807ba9e9c82f.js"
            integrity="sha512-5vjGPz7Zrvqc7bO&#43;PVq2fgC8PPh6jdfvHtVdZC6afYCDdjaiaud/ln8qp0pErnDEE04lq8pYfwSMYIB7qenILw=="></script>
    
        
        <script
            type="text/javascript"
            src="/_theme/js/sidebar.01b59c615736643387108a100de70c51d5e98477bdc338244a87d37f7e38286b48683459eade68087f0688f0235e7a48691e633954fa930d41823e9ddf797085.js"
            integrity="sha512-AbWcYVc2ZDOHEIoQDecMUdXphHe9wzgkSofTf344KGtIaDRZ6t5oCH8GiPAjXnpIaR5jOVT6kw1Bgj6d33lwhQ=="></script>
    















<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />




</html>
